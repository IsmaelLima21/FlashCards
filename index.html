<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Elegant Flashcards</title>
<!-- jQuery (debe ir antes de Bootstrap) -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- Bootstrap -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
<!-- SortableJS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.js"></script>
<!-- html2canvas para Captura -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.min.js"></script>
<!--Google Font-->
<link href="https://fonts.googleapis.com/css2?family=Lato&family=Montserrat&family=Open+Sans&family=Poppins&family=Raleway&family=Roboto&family=Sofia&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<link href="https://fonts.cdnfonts.com/css/gill-sans-2" rel="stylesheet">
<!--Font Awesome-->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
<!--Animate.css-->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
</head>
<!-- Quill CSS -->
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<!-- Quill JS -->
<script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>

<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Raleway', Roboto, Helvetica, Arial, sans-serif;
    font-size: 20px;
    background-color: #f5f5f5;
    margin: 0;
    padding: 0;
    display: flex;
    min-height: 100vh;
    color: #333;
  }
  .left-container {
    width: 380px;
    background-color: #ffffff;
    box-shadow: 0 4px 8px rgba(0,0,0,0.22);
    /*box-shadow: 2px 0 10px rgba(0,0,0,0.4);*/
    overflow-y: auto;
    padding: 20px;
  }
  .right-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background-color: #f9f9f9;
    padding: 30px;
    position: relative;
  }
  h1, h2 {
    color: #424242;
    text-align: center;
    margin-bottom: 20px;
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
  }
  .categories {
    margin-bottom: 10px;
    height: 160px;
    overflow-y: auto;
  }
  .category {
    display: flex;
    align-items: center;
    margin-bottom: 4px;
    cursor: pointer;
    padding: 2px;
    border-radius: 8px;
    transition: background-color 1.0s;
  }
  .category:hover {
    background-color: #f0f0f0;
  }
  .category-icon {
    width: 22px;
    height: 22px;
    margin-right: 12px;
    background-color: #e0e0e0;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    color: #fff;
  }
  .category-name {
    font-size: 15px;
    flex-grow: 1;
  }
  
.category-count {
    margin-left: auto;
    color: #888;
    font-size: 14px;
  }

  .category-remove {
    margin-left: 10px;
    color: rgba(0,0,0,0.001);
    cursor: pointer;
    font-size: 18px;
  }
  .flashcard {
    width: 420px;
    height: 740px;
    perspective: 1000px;
    cursor: pointer;
  }
  .flashcard-inner {
    position: relative;
    width: 100%;
    height: 100%;
    text-align: center;
    transition: transform 1.0s;
    transform-style: preserve-3d;
  }
  .flashcard.flipped .flashcard-inner {
    transform: rotateY(180deg);
  }
  .flashcard-front, .flashcard-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    padding: 20px;
    box-sizing: border-box;
    border-radius: 16px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.22);
    background-color: #ffffff;
  }
  .flashcard-back {
    transform: rotateY(180deg);
  }
  .flashcard-title {
    font-size: 24px;
    font-weight: bold;
    margin-bottom: 20px;
  }
  .flashcard-description {
    font-size: 16px;
    line-height: 120%;
    color: #666;
  }


/* ----------- Renderizado de quil en la tarjeta-------*/
.card-text {
    text-align: left;
    word-wrap: break-word;
    white-space: pre-wrap;
    padding: 10px;
    font-size: 14px;
    line-height: 1.6;
    color: #333;
}
.card-text p {
    margin: 0;
}
.card-text img {
    max-width: 100%;
    height: auto;
    display: block;
    margin: 10px 0;
}
.card-text blockquote {
    border-left: 4px solid #ccc;
    padding-left: 10px;
    margin: 10px 0;
    color: #666;
}
.card-text pre {
    background-color: #f5f5f5;
    padding: 10px;
    border-radius: 4px;
    overflow: auto;
}
  
/*-----------END----------------*/




  .flashcard-controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    margin-top: 20px;
  }
  .card-number {
    font-size: 14px;
    color: #888;
  }
  .add-to-stack {
    background-color: #ff6b6b;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 20px;
    cursor: pointer;
    font-size: 14px;
  }
  .nav-button {
    background-color: transparent;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: #888;
  }

/* Pendiente Editar campos */

    input[type="text"], input[type="file"], select, textarea {
    font-family: 'Raleway';
    font-size: 12px;
    width: 100%;
    padding: 10px;
    margin: 8px 0;
    box-sizing: border-box;
    border: 1px solid #dedede;
    border-radius: 8px;
  }
 textarea {
    resize: vertical;
    min-height: 100px;
  }

  button {
    background-color: #fff;
    border: 1px solid #e8e8e8;
    color: #666;
    padding: 6px 15px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 14px;
    margin: 4px 2px;
    cursor: pointer;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    transition: background-color 0.3s;
  }
  button:hover {
    color: #666;
    background-color: #fff;
    border: 1px solid #c4c4c4;
  }
  .color-option {
    width: 20px;
    height: 20px;
    border-radius: 8%;
    display: inline-block;
    margin: 0 5px;
    cursor: pointer;
    /*border: 1px solid #666;*/
  }
  .miniature-container {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    height: 450px;
    margin-top: 10px;
    background-color: #f1f1f1;
    padding: 16px 24px;
    border-radius: 6px;
    overflow-y: auto;
  }
  .miniature-card {
    width: 80px;
    height: 130px;
    border: 1px solid #ccc;
    border-radius: 5px;
    padding: 6px;
    font-size: 12px;
    overflow: hidden;
    cursor: pointer;
    position: relative;
    background-color: #fff;
  }
  .miniature-actions {
    position: absolute;
    bottom: 5px;
    left: 5px;
    right: 5px;
    display: flex;
    justify-content: space-between;
  }
  .miniature-actions button {
    color: #000;
    border-radius: 6px;
    padding: 2px 5px;
    font-size: 8px;
  }

.save-indicator {
    position: absolute;
    top: 20px;
    left: 40px; /* Cambiado de right a left */
    padding: 10px;
    background-color: #ff1f4b;
    color: white;
    border-radius: 7px;
    opacity: 0;
    box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
    transition: opacity 2.0s ease;
}
  .save-indicator.show {
    opacity: 1;
  }

  .edit-card-modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    /*background-color: rgba(255,255,255,0.01);*/
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);	
    overflow-y: auto;
  }
  .edit-card-content {
    background-color: rgba(255,255,255,0.5);
    /*background-color: #fefefe;*/
    margin: 7% auto;
    padding: 24px;
    border: 1px solid #ff2954;
    width: 60%;
    max-width: 480px;
    border-radius: 12px;
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);	
    box-shadow: 0 4px 8px rgba(0, 0, 0,0.25); 
  }
  .close-modal {
    color: #3b3b3b;
    float: right;
    font-size: 28px;
    font-weight: normal;
    cursor: pointer;
  }
  .close-modal:hover,
  .close-modal:focus {
    color: #ff2954;
    text-decoration: none;
    cursor: pointer;
  }


/* Estilos para el acordeón */
  .accordion {
            margin-top: 4px;
        }
        .accordion-item {
            /*border: 1px solid #ff2954;*/
            border: 1px solid rgba(255,255,255,0.65);
            border-radius: 8px;
            margin-bottom: 10px;
            overflow: hidden;
        }
        .accordion-header {
            /*border: 1px solid #ff2954;*/
            background-color: rgba(255,255,255,0.6);
            padding: 10px;
            cursor: pointer;
            transition: background-color 0.5s ease;
        }
        .accordion-header:hover {
            background-color: rgba(255,255,255,0.1);
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 1.2s ease-out;
            background-color: rgba(255,255,255,0.03);
        }
        .accordion-content.active {
            max-height: auto; /* Ajusta este valor según el contenido máximo esperado */
            transition: max-height 1.2s ease-in;
        }

        .accordion-header::after {
            content: '\02795'; /* Unicode character for "plus" sign (+) */
            font-size: 13px;
            font-weight: normal;
            color: #ff2954;
            float: right;
            margin-left: 5px;
        }
        .accordion-header.active::after {
            content: "\2796"; /* Unicode character for "minus" sign (-) */
            color: #ff2954;
        }


  .new-card-miniature {
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    font-weight: bold;
    color: #ff2954;
    border: 1px solid #ff2954;
    background-color: #fff;
    box-shadow: 0 2px 6px rgba(255, 41, 84,0.39); 
  }


/* Estilos del Modal About */
.modal {
    display: none; /* Oculto por defecto */
    position: fixed; 
    z-index: 1000; 
    left: 0;
    top: -70px;
    width: 100%;
    height: 100%;
    overflow: auto;
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);	
    background-color: rgba(0, 0, 0, 0.0); /* Fondo oscuro con opacidad */
}

.modal-content {
    background: rgba(255, 255, 255, 0.70);
    font-size: 15px;
    font-weight: normal;
    margin: 10% auto;
    padding: 45px;
    width: 620px; 
    height: auto;
    box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);    
    border-radius: 14px;
    border: 1px solid rgb(255, 255, 255, 0.79);
    /*border: 1px solid rgb(255, 41, 84, 1.0);*/    
    /*overflow-y: auto;  Scroll si el contenido es demasiado grande */
}


.modal-footer {
    display: flex;
    justify-content: center;  /* Centra el botón horizontalmente */
    align-items: flex-end;    /* Coloca el botón en la parte inferior del contenedor */
    height: 100px;            /* Ajusta la altura del contenedor según sea necesario */
    position: relative;
}

.close {
    color: #aaa;
    float: right;
    font-size: 24px;
    font-weight: normal;
}

.close:hover,
.close:focus {
    color: #ff2954;
    text-decoration: none;
    cursor: pointer;
}


.btn.btn-info {
    background-color: #17a2b8;
    border-color: #17a2b8;
    color: #fff;
    padding: 10px 20px;
    font-size: 16px;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s, border-color 0.3s;
}

.btn.btn-info:hover {
    background-color: #138496;
    border-color: #117a8b;
}

.btn.btn-info:focus {
    outline: none;
    box-shadow: 0 0 5px rgba(23, 162, 184, 0.5);
}
    
    .copy {    
    padding: 6px 15px;
    margin: 4px 2px;
   border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    transition: background-color 0.3s;
  }


.custom-toast {
  position: fixed;
    top: 20px;
    left: 420px;
    padding: 10px;
    background-color: #ff1f4b;
    color: white;
    border-radius: 7px;
    opacity: 0;
    box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
    transition: opacity 2.0s ease;
}


.custom-toast.show {
  visibility: visible; /* Visible cuando se activa */
  opacity: 1; /* Opacidad completa */
}

.toast-close-btn {
  background: none;
  border: none;
  color: #fff;
  font-size: 14px;
  cursor: pointer;
  float: right;
}


.flashcard {
  perspective: 1000px;
}

.flashcard-inner {
  transition: transform 0.9s;
  transform-style: preserve-3d;
  position: relative;
}

.flashcard.flipped .flashcard-inner {
  transform: rotateY(180deg);
}


.flashcard {
    transition: transform 0.5s ease-in-out, opacity 0.5s ease-in-out;
    transform: scale(1);
    opacity: 1;
}

.flashcard-leaving {
    transform: scale(0.8);
    opacity: 0;
}

.flashcard-entering {
    transform: scale(1.2);
    opacity: 0;
}


/* Estilos CSS adicionales (puedes agregarlos a tu archivo CSS)*/

.reorder-indicator {
  position: absolute;
  top: 20px;
  left: 420px; /* Cambiado de right a left */
  background-color: #ff1f4b;  // Un color verde para diferenciar del indicador de guardado general
  color: white;
  padding: 10px;
  border-radius: 7px;  
  z-index: 1000;
  opacity: 0;
  box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);  
  transition: opacity 0.6s ease-in-out;
}

.reorder-indicator.show {
  opacity: 1;
}


/*  .save-indicator {
    top: 20px;
    right: 20px;
    padding: 10px;
    transition: opacity 2.0s ease; 
*/


/* TIMER STYLES */

.TimerModal {
    position: fixed;
    bottom: -320px;
    right: 20px;
    width: 160px;
    height: 320px;
    background-color: rgba(255, 255, 255, 0.6);
    border-radius: 10px;
    border: 1px solid rgba(0, 0, 0, 0.15);
    overflow: hidden;
    transition: bottom 1.0s ease-in-out;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  }
  .TimerModal.show {
    bottom: 40px; /* Ajusta este valor para mover la caja más arriba */
}
  .timer-container {
    padding: 15px;
    display: flex;
    flex-direction: column;
    justify-content: space-evenly;
    flex-wrap: nowrap; 
    height: 100%;
    box-sizing: border-box;
  }
  .timer-circle {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: conic-gradient(#ff3b7f 270deg, #f0f0f0 270deg);
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 0 auto;
    position: relative;
  }
  .timer-circle::before {
    content: "";
    position: absolute;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background-color: white;
  }
  .timer-display {
    font-size: 18px;
    font-weight: 200;
    color: #9e9e9e;
    position: relative;
    z-index: 1;
  }
  .timer-unit {
    font-size: 12px;
    color: #888;
    position: relative;
    z-index: 1;
  }

.timer-buttons, .preset-buttons {
    display: flex;
    justify-content: space-between;
    margin-top: 2px;
  }
  .timer-button, .preset-button {
    width: 36px;
    height: 36px;
    border-radius: 22%;
    border: 1px solid #e8e8e8;
    font-size: 12px;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    transition: background-color 0.3s;
  }
  .timer-button {
    background-color: #ff3b7f;
    color: white;
  }
  .timer-button:hover {
    background-color: #fff;
    color: #ff3b7f; 
  }
  .preset-button {
    background-color: #fff;
    color: #666;
  }
  .preset-button:hover {
    background-color: #ff3b7f;
    color: #fff;
  }
  .custom-time-input {
    display: flex;
    justify-content: space-between;
    margin-top: 26px;
  }
 .custom-time-input input {
    width: 45%;
    padding: 2px;
    background-color: #fff;
    border: 1px solid #ccc;
    border-radius: 5px;
    text-align: center;
    font-size: 14px;
  }

  .show-TimerModal-button {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background-color: #ff3b7f;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    font-size: 14px;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  .show-TimerModal-button:hover {
    background-color: #e91e63;
  }
  .notification {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 10px;
    background-color: #ff1f4b;
    color: white;
    border-radius: 7px;
    opacity: 0;
    box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
    transition: opacity 2.0s ease;
  }
  .notification.show {
    opacity: 1;
  }

 
/* TIMER STYLE END */


/* ESTILOS DEL TOOLTIP*/

.tooltip-container {
    position: relative;
    display: inline-block;
}

.tooltip {
    visibility: hidden;
    width: 150px;
    background-color: #fff;
    color: #666;
    text-align: center;
    border: 1px solid #ccc;
    border-radius: 8px;
    padding: 6px 15px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    transition: background-color 0.3s;
    position: absolute;
    z-index: 1;
    bottom: 125%; /* Posición del tooltip */
    left: 50%;
    margin-left: -75px; /* Centra el tooltip */
    opacity: 0;
    transition: opacity 1.0s;
}

.tooltip-container:hover .tooltip {
    visibility: visible;
    opacity: 1;
}
/* FIN DE ESTILO TOOLTIP*/



/* CSS para los editores de Quill */
#editFrontTextContainer, #editBackTextContainer {
    height: 200px;
}

/*
/* Ajustes para el modal y acordeón*/ 
.edit-card-modal {
    /* Añadir estilos para el modal si es necesario */
}

.accordion-content {
    /* Añadir estilos para el contenido del acordeón si es necesario */
}
*/

.ql-snow .ql-picker.ql-font span[data-value="lato"]::before {
    font-family: 'Lato', sans-serif;
}

.ql-snow .ql-picker.ql-font span[data-value="montserrat"]::before {
    font-family: 'Montserrat', sans-serif;
}

.ql-snow .ql-picker.ql-font span[data-value="raleway"]::before {
    font-family: 'Raleway', sans-serif;
}


/* ----------NUEVO NEW------------*/


  #editor-container {
    flex: 1;
    display: flex;
    flex-direction: column;
  }
  #editor {
    flex: 1;
    border: 1px solid #ccc;
    border-radius: 5px;
  }
  .ql-font-raleway { font-family: 'Raleway', sans-serif; }
  .ql-font-montserrat { font-family: 'Montserrat', sans-serif; }
  .ql-font-poppins { font-family: 'Poppins', sans-serif; }
  .ql-font-opensans { font-family: 'Open Sans', sans-serif; }
  .ql-font-sofia { font-family: 'Sofia', cursive; }
  .ql-font-lato { font-family: 'Lato', sans-serif; }
  .ql-font-roboto { font-family: 'Roboto', sans-serif; }

  /* Estilos para mostrar el nombre de la fuente en el selector */
  .ql-font .ql-picker-item::before,
  .ql-font .ql-picker-label::before {
    content: attr(data-value) !important;
  }
  .ql-font .ql-picker-item[data-value]::before {
    font-size: 14px !important;
  }
  .ql-font .ql-picker-item {
    padding-top: 5px !important;
    padding-bottom: 5px !important;
  }

  /* Estilos para mostrar el tamaño de la fuente en el selector */
  .ql-size .ql-picker-item::before,
  .ql-size .ql-picker-label::before {
    content: attr(data-value) !important;
  }




.SaveCategorienotification {
    position: fixed;
    top: 20px;
    left: 420px;
    padding: 10px;
    background-color: #ff1f4b;
    color: white;
    border-radius: 7px;
    opacity: 0;
    box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
    transition: opacity 2.0s ease;
  }

  .color-grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 6px;
    margin-top: 10px;
    margin-left: 28px;
  }

  .color-option {
    width: 22px;
    height: 22px;
    border-radius: 5px;
    display: inline-block;
    cursor: pointer;
    border: 1px solid #c4c4c4;
    /*border: 1px solid transparent;*/
    transition: border-color 0.2s ease;
    box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);	
  }

  .color-option:hover, .color-option.selected {
    /*border-color: #6e6e6e;*/
    box-shadow: 0 0px 4px rgba(0, 0, 0, 0.45);	
  }

  .color-option[data-color="gradient-1"] {
    background: linear-gradient(135deg, #c7a9e9, #a1c4fd);
  }

  .color-option[data-color="gradient-2"] {
    background: linear-gradient(135deg, #fccb90, #d57eeb);
  }

  .color-option[data-color="gradient-3"] {
    background: linear-gradient(135deg, #d4fc79, #96e6a1);
  }

  .color-option[data-color="gradient-4"] {
    background: linear-gradient(135deg, #aa9cfc, #fc9ce7);
  }

  .color-option[data-color="gradient-5"] {
    background: linear-gradient(135deg, #f794a4, #fdd6bd);
  }

  .color-option[data-color="paper-1"] {
    background-color: #fff;
    background-image: url('data:image/svg+xml;utf8,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><rect width="100" height="100" fill="none" stroke="%23ccc" stroke-width="0.5"/></svg>');
  }

  .color-option[data-color="paper-2"] {
    background-color: #f9f9f9;
    background-image: url('data:image/svg+xml;utf8,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="1" fill="%23ccc"/></svg>');
  }

  .color-option[data-color="paper-3"] {
    background-color: #f5f5f5;
    background-image: url('data:image/svg+xml;utf8,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><path d="M0 0 L10 10 M10 0 L0 10" stroke="%23ddd" stroke-width="0.5"/></svg>');
  }

  .color-option[data-color="paper-4"] {
    background-color: #fff;
    background-image: url('data:image/svg+xml;utf8,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><rect width="100" height="1" fill="%23eee"/><rect width="1" height="100" fill="%23eee"/></svg>');
  }

  .color-option[data-color="paper-5"] {
    background-color: #fafafa;
    background-image: url('data:image/svg+xml;utf8,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="25" fill="none" stroke="%23eee" stroke-width="0.5"/></svg>');
  }




</style>
</head>
<body>
  <div class="left-container" id="leftContainer">
    <h1>Categories</h1>
    <div class="categories" id="categoriesContainer">
      <!-- Categories will be dynamically populated here -->
    </div>
    <div id="miniatures" style="margin-top: 20px;">
      <h2>Cards in <span id="currentStackName">Default Stack</span></h2>
      <div class="miniature-container" id="miniatureContainer"></div>
    </div>
    <div id="stackManagement" style="margin-top: 20px;">
      <h2>Stack Management</h2>
      <button id="newStackBtn">New Stack</button>
      <button id="saveStackBtn">Save Stack</button>
      <button id="exportStackBtn">Export Stack</button>
      <input type="file" id="importStackInput" accept=".json" style="display: none;">
      <button id="importStackBtn">Import Stack</button>
      <button id="removeStackBtn">Delete Stack</button>
    </div>
  </div>
  
  <div class="right-container">

<!-- La tarjetita que quieres capturar -->

<div class="flashcard" id="flashcard">
    <div class="flashcard-inner">
        <div class="flashcard-front">
            <div class="flashcard-title" id="frontCardTitle">Flashcard Title</div>
           
            

	   <div class="flashcard-description" id="frontText">This is a brief description or question for the flashcard. Tap to see the answer!</div>

	    <div class="card-text"></div> 	

            <img id="frontCardImage" class="card-image" src="" alt="" style="display: none; max-width: 100%; max-height: 50%;">
        </div>
        <!-- La parte de atrás de la tarjeta -->
        <div class="flashcard-back">
          <div class="flashcard-title" id="backCardTitle">Answer Title</div>

	  <div class="card-text"></div> 

          <div class="flashcard-description" id="backText"></div>
          <img id="backCardImage" class="card-image" src="" alt="" style="display: none; max-width: 100%; max-height: 50%;">
           </div>
      </div>
    </div>

<div class="save-indicator" id="saveIndicator">Stack Saved!</div>
    <div class="flashcard-controls">
      <button class="nav-button" id="prevBtn">&#8592;</button>
      <div class="card-number">
        <span id="currentCardNumber">1</span> / <span id="totalCards">5</span>
      </div>
      <button id="customEditButton">Edit this Card</button>
      <button class="nav-button" id="nextBtn">&#8594;</button>
    </div>
	<div class="reorder-controls">
      <!-- <button id="moveUpBtn">Move Up</button>-->
      <!-- <button id="moveDownBtn">Move Down</button>-->
	
	<!-- Botón para abrir el Modal de About -->
<button id="openAboutModal" class="Open">About</button>

        <!-- Botón Guardar Imagen -->

<div class="tooltip-container">
    <button id="saveFrontAsJPG"><i class="fa fa-download"></i></button>
    <span class="tooltip">Guardar Frente como Imagen</span>
</div>

<div class="tooltip-container">
    <button id="saveBackAsJPG"><i class="fa fa-download"></i></button>
    <span class="tooltip">Guardar Revez como Imagen</span>
</div>

	
	<!-- Botón para abrir el TIMER MODAL -->
 <button class="Open" id="showTimerModalButton">Show Timer</button>

	<!-- NOTIFICATION DIV TIMER -->
<div class="notification" id="notification">Timer Started</div>


    </div>

  </div>

<!-- TIMER MODAL -->

<div class="TimerModal" id="TimerModal">
    <div class="timer-container">
      <div class="timer-circle">
        <div class="timer-display" id="timer">27<span class="timer-unit">sec</span></div>
      </div>
      <div class="custom-time-input">
        <input type="number" id="minutesInput" placeholder="Min" min="0" max="59">
        <input type="number" id="secondsInput" placeholder="Sec" min="0" max="59">
      </div>
      <div class="preset-buttons">
        <button class="preset-button" data-time="300">5m</button>
        <button class="preset-button" data-time="600">10m</button>
        <button class="preset-button" data-time="900">15m</button>
      </div>
      <div class="preset-buttons">
        <button class="preset-button" data-time="1200">20m</button>
        <button class="preset-button" data-time="1800">30m</button>
        <button class="preset-button" data-time="3600">1h</button>
      </div>
      <div class="timer-buttons">
        <button id="startButton" class="timer-button">&#9658;</button>
        <button id="pauseResumeButton" class="timer-button">&#10074;&#10074;</button>
        <button id="resetButton" class="timer-button">&#8634;</button>
      </div>
    </div>
  </div>
  


<!-- Modal Edit Card -->

<!-- <button onclick="openEditModal(0)">Open Edit Modal</button> -->

    <div id="editCardModal" class="edit-card-modal">
        <div class="edit-card-content">
            <span class="close-modal">&times;</span>
            <h2 id="editCardTitle">Edit Card</h2>            
            <div class="accordion">
                <div class="accordion-item">
                    <div class="accordion-header">Front Side</div>
                    <div class="accordion-content">
                        <select id="frontTitleFont" style="display: none">
                            	<option value="Lato">Lato</option>
				<option value="Montserrat">Montserrat</option>
				<option value="Raleway">Raleway</option>
				<option value="Sofia">Sofia</option>
                                <option value="Poppins">Poppins</option>
        			<option value="Arial">Arial</option>
       				<option value="Verdana">Verdana</option>
        			<option value="Times New Roman">Times New Roman</option>
        			<option value="Courier New">Courier New</option>
        			<option value="Georgia">Georgia</option>
                        </select>
			<input type="text" id="editFrontTitle" placeholder="Front Card Title" style="display: none">      
                         

			<!-- Quill Editor for Front Side -->
			
			<div id="editFrontTextEditor" style="height: 200px;"></div> 


			<select id="frontTextFont" style="display: none">
                                <option value="Lato">Lato</option>
				<option value="Montserrat">Montserrat</option>
				<option value="Raleway">Raleway</option>
				<option value="Sofia">Sofia</option>
                                <option value="Poppins">Poppins</option>
        			<option value="Arial">Arial</option>
       				<option value="Verdana">Verdana</option>
        			<option value="Times New Roman">Times New Roman</option>
        			<option value="Courier New">Courier New</option>
        			<option value="Georgia">Georgia</option>
                        </select>
                        <textarea id="editFrontText" placeholder="Front side text" style="display: none"></textarea>
                        <input type="file" id="editFrontImage" accept="image/*" style="display: none">
                        <button class="remove-media-btn" id="removeFrontImage" style="display: none">Remove Front Image</button>
                        </div>
                </div>
                
                <div class="accordion-item">
                    <div class="accordion-header">Back Side</div>
                    <div class="accordion-content">
                        <select id="backTitleFont" style="display: none">
                            	<option value="Lato">Lato</option>
				<option value="Montserrat">Montserrat</option>
				<option value="Raleway">Raleway</option>
				<option value="Sofia">Sofia</option>
                                <option value="Poppins">Poppins</option>
        			<option value="Arial">Arial</option>
       				<option value="Verdana">Verdana</option>
        			<option value="Times New Roman">Times New Roman</option>
        			<option value="Courier New">Courier New</option>
        			<option value="Georgia">Georgia</option>
                        </select>
                        <input type="text" id="editBackTitle" placeholder="Back Card Title" style="display: none">

                        			<!-- Quill Editor for Back Side -->
                        <div id="editBackTextEditor" style="height: 200px;"></div>

			<select id="backTextFont" style="display: none">
                            <option value="Lato">Lato</option>
				<option value="Montserrat">Montserrat</option>
				<option value="Raleway">Raleway</option>
				<option value="Sofia">Sofia</option>
                                <option value="Poppins">Poppins</option>
        			<option value="Arial">Arial</option>
       				<option value="Verdana">Verdana</option>
        			<option value="Times New Roman">Times New Roman</option>
        			<option value="Courier New">Courier New</option>
        			<option value="Georgia">Georgia</option>
                        </select>
                        <textarea id="editBackText" placeholder="Back side text" style="display: none"></textarea>
                        <input type="file" id="editBackImage" accept="image/*" style="display: none">
                        <button class="remove-media-btn" id="removeBackImage" style="display: none">Remove Back Image</button>
                        </div>
                </div>
                
                <div class="accordion-item">
                    <div class="accordion-header">Card Color</div>
                    <div class="accordion-content">
                        <div class="color-grid">
<!-- Blancos / tonos de grises suaves -->
<div class="color-option" style="background-color: #FFFFFF;" data-color="#FFFFFF"></div>
<div class="color-option" style="background-color: #FAFAFA;" data-color="#FAFAFA"></div>
<div class="color-option" style="background-color: #F5F5F5;" data-color="#F5F5F5"></div>
<div class="color-option" style="background-color: #F0F0F0;" data-color="#F0F0F0"></div>
<div class="color-option" style="background-color: #EBEBEB;" data-color="#EBEBEB"></div>
<div class="color-option" style="background-color: #E6E6E6;" data-color="#E6E6E6"></div>
 			<!-- Rojos claros -->
<div class="color-option" style="background-color: #FF8080;" data-color="#FF8080"></div>
<div class="color-option" style="background-color: #FFADAD;" data-color="#FFADAD"></div>
<div class="color-option" style="background-color: #FFB7B7;" data-color="#FFB7B7"></div>
<div class="color-option" style="background-color: #FFC1C1;" data-color="#FFC1C1"></div>
<div class="color-option" style="background-color: #FFCBCB;" data-color="#FFCBCB"></div>
<div class="color-option" style="background-color: #FFD5D5;" data-color="#FFD5D5"></div>

<!-- Naranjas claros -->
<div class="color-option" style="background-color: #FFBA80;" data-color="#FFBA80"></div>
<div class="color-option" style="background-color: #FFD0AD;" data-color="#FFD0AD"></div>
<div class="color-option" style="background-color: #FFD6B9;" data-color="#FFD6B9"></div>
<div class="color-option" style="background-color: #FFDCC5;" data-color="#FFDCC5"></div>
<div class="color-option" style="background-color: #FFE2D1;" data-color="#FFE2D1"></div>
<div class="color-option" style="background-color: #FFE8DD;" data-color="#FFE8DD"></div>

<!-- Amarillos claros -->
<div class="color-option" style="background-color: #FFF280;" data-color="#FFF280"></div>
<div class="color-option" style="background-color: #FFF5AD;" data-color="#FFF5AD"></div>
<div class="color-option" style="background-color: #FFF6B7;" data-color="#FFF6B7"></div>
<div class="color-option" style="background-color: #FFF7C1;" data-color="#FFF7C1"></div>
<div class="color-option" style="background-color: #FFF8CB;" data-color="#FFF8CB"></div>
<div class="color-option" style="background-color: #FFF9D5;" data-color="#FFF9D5"></div>

<!-- Verdes claros -->
<div class="color-option" style="background-color: #BFEA80;" data-color="#BFEA80"></div>
<div class="color-option" style="background-color: #D4EDAD;" data-color="#D4EDAD"></div>
<div class="color-option" style="background-color: #DBF0B9;" data-color="#DBF0B9"></div>
<div class="color-option" style="background-color: #E2F3C5;" data-color="#E2F3C5"></div>
<div class="color-option" style="background-color: #E9F6D1;" data-color="#E9F6D1"></div>
<div class="color-option" style="background-color: #F0F9DD;" data-color="#F0F9DD"></div>

<!-- Verdes pastel -->
<div class="color-option" style="background-color: #99F299;" data-color="#99F299"></div>
<div class="color-option" style="background-color: #B5F5B5;" data-color="#B5F5B5"></div>
<div class="color-option" style="background-color: #C1F7C1;" data-color="#C1F7C1"></div>
<div class="color-option" style="background-color: #CDFACD;" data-color="#CDFACD"></div>
<div class="color-option" style="background-color: #D9FCD9;" data-color="#D9FCD9"></div>
<div class="color-option" style="background-color: #E5FEE5;" data-color="#E5FEE5"></div>

<!-- Azules claros -->
<div class="color-option" style="background-color: #80D5FF;" data-color="#80D5FF"></div>
<div class="color-option" style="background-color: #ADE5FF;" data-color="#ADE5FF"></div>
<div class="color-option" style="background-color: #B9E9FF;" data-color="#B9E9FF"></div>
<div class="color-option" style="background-color: #C5EDFF;" data-color="#C5EDFF"></div>
<div class="color-option" style="background-color: #D1F1FF;" data-color="#D1F1FF"></div>
<div class="color-option" style="background-color: #DDF5FF;" data-color="#DDF5FF"></div>

<!-- Azules pastel -->
<div class="color-option" style="background-color: #99C5FF;" data-color="#99C5FF"></div>
<div class="color-option" style="background-color: #B5D8FF;" data-color="#B5D8FF"></div>
<div class="color-option" style="background-color: #C1DEFF;" data-color="#C1DEFF"></div>
<div class="color-option" style="background-color: #CDE4FF;" data-color="#CDE4FF"></div>
<div class="color-option" style="background-color: #D9EAFF;" data-color="#D9EAFF"></div>
<div class="color-option" style="background-color: #E5F0FF;" data-color="#E5F0FF"></div>

<!-- Morados claros -->
<div class="color-option" style="background-color: #C080FF;" data-color="#C080FF"></div>
<div class="color-option" style="background-color: #E0D0FF;" data-color="#E0D0FF"></div>
<div class="color-option" style="background-color: #E5D8FF;" data-color="#E5D8FF"></div>
<div class="color-option" style="background-color: #EAE0FF;" data-color="#EAE0FF"></div>
<div class="color-option" style="background-color: #EFE8FF;" data-color="#EFE8FF"></div>
<div class="color-option" style="background-color: #F4F0FF;" data-color="#F4F0FF"></div>

<!-- Rosas claros -->
<div class="color-option" style="background-color: #FF80EB;" data-color="#FF80EB"></div>
<div class="color-option" style="background-color: #FFD0F5;" data-color="#FFD0F5"></div>
<div class="color-option" style="background-color: #FFD8F7;" data-color="#FFD8F7"></div>
<div class="color-option" style="background-color: #FFE0F9;" data-color="#FFE0F9"></div>
<div class="color-option" style="background-color: #FFE8FB;" data-color="#FFE8FB"></div>
<div class="color-option" style="background-color: #FFF0FD;" data-color="#FFF0FD"></div>

<!-- Variaciones pastel -->
<div class="color-option" style="background-color: #CCFFED;" data-color="#CCFFED"></div>
<div class="color-option" style="background-color: #E6FFF2;" data-color="#E6FFF2"></div>
<div class="color-option" style="background-color: #EBFFF4;" data-color="#EBFFF4"></div>
<div class="color-option" style="background-color: #F0FFF6;" data-color="#F0FFF6"></div>
<div class="color-option" style="background-color: #F5FFF8;" data-color="#F5FFF8"></div>
<div class="color-option" style="background-color: #FAFFFA;" data-color="#FAFFFA"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <button id="saveEditBtn">Save Changes</button>
        </div>
    </div>




<!-- Toast personalizado -->
<div id="customToast" class="custom-toast">
  <span id="toastMessage">Mensaje del toast aquí.</span>  
</div>




<!-- Modal About-->
<div id="aboutModal" class="modal">
    <div class="modal-content">
	<span class="close">&times;</span>
        
	<h2>About this Application</h2>
        <p>Hello and Welcome, My name is Ismael, the Creator of this application that allows you to manage and organize your flashcards efficiently.</p> 

<p>You can create, edit, save, delete, and sort your cards easily. The application also offers features like image, and even Video Links  attachments.</p>

 <p>Your cards are saved and stored locally in your computer, that means nobody else can see them, unless you share the JSON file.</p>

        <p>Customize the cards with different colors and fonts, and save your progress for later use. The application is designed to be intuitive, minimalistic, and user-friendly, I hope you enjoy it. ❤️</p>

<p>If you like our app, consider supporting the project through PayPal or Cafecito. Your donation makes a difference.</p> 

<p>v 01.28</p> 

 <p>Con cariño, para que disfrutes aprendiendo, Adri ❤️</p>

    
      <div class="modal-footer">

	<a href="https://cafecito.app/theartificialpixel" target="_blank"><button class="link">Cafesito</button></a>

	<a href="https://www.paypal.com/donate/?business=CDCB3L5W4SKGN&no_recurring=0&item_name=Tu+donaci%C3%B3n+ayuda+a+mejorar+nuestra+aplicaci%C3%B3n+de+tarjetas.+%C2%A1Gracias+por+apoyar+nuestro+proyecto+y+hacer+que+siga+mejorando%21&currency_code=USD" target="_blank"><button class="link">Paypal</button></a>
   
	</div>
    </div>
</div>

<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
  <script>
// Default Cards
    let flashcardStacks = {
      default: [
        { frontTitle: "Geography", backTitle: "Answer", frontText: "What is the capital of France?", backText: "Paris", color: "#FFB3BA", frontTitleFont: "Raleway", frontTextFont: "Montserrat", backTitleFont: "Raleway", backTextFont: "Montserrat" },
        { frontTitle: "Literature", backTitle: "Answer", frontText: "Who wrote 'Romeo and Juliet'?", backText: "William Shakespeare", color: "#BAFFC9", frontTitleFont: "Raleway", frontTextFont: "Montserrat", backTitleFont: "Raleway", backTextFont: "Montserrat" },
        { frontTitle: "Chemistry", backTitle: "Answer", frontText: "What is the chemical symbol for gold?", backText: "Au", color: "#BAE1FF", frontTitleFont: "Raleway", frontTextFont: "Montserrat", backTitleFont: "Raleway", backTextFont: "Montserrat" },
        { frontTitle: "History", backTitle: "Answer", frontText: "In which year did World War II end?", backText: "1945", color: "#FFFFBA", frontTitleFont: "Raleway", frontTextFont: "Montserrat", backTitleFont: "Raleway", backTextFont: "Montserrat" },
        { frontTitle: "Astronomy", backTitle: "Answer", frontText: "What is the largest planet in our solar system?", backText: "Jupiter", color: "#FFDFBA", frontTitleFont: "Raleway", frontTextFont: "Montserrat", backTitleFont: "Raleway", backTextFont: "Montserrat" }
      ]
    };

    let currentStack = 'default';
    let currentCardIndex = 0;
    let selectedColor = "#FFFFFF";

    let countdown;
    let totalTime;
    let timeLeft;
    let isPaused = false;
    let isActive = false;
    
// Nueva variable global para controlar la edición de categorías
    let isEditingCategoryName = false;

    const flashcardElement = document.getElementById('flashcard');
    const frontCardTitleElement = document.getElementById('frontCardTitle');
    const backCardTitleElement = document.getElementById('backCardTitle');
    const frontTextElement = document.getElementById('frontText');
    const backTextElement = document.getElementById('backText');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const newStackBtn = document.getElementById('newStackBtn');
    const saveStackBtn = document.getElementById('saveStackBtn');
    const frontCardImage = document.getElementById('frontCardImage');
    const backCardImage = document.getElementById('backCardImage');
    const frontCardAudio = document.getElementById('frontCardAudio');
    const backCardAudio = document.getElementById('backCardAudio');
    const colorOptions = document.querySelectorAll('.color-option');
    const exportStackBtn = document.getElementById('exportStackBtn');
    const importStackBtn = document.getElementById('importStackBtn');
    const importStackInput = document.getElementById('importStackInput');
    const miniatureContainer = document.getElementById('miniatureContainer');
    const saveIndicator = document.getElementById('saveIndicator');
    const editCardModal = document.getElementById('editCardModal');
    const editCardTitle = document.getElementById('editCardTitle');
    const closeModal = document.querySelector('.close-modal');
    const editFrontTitleInput = document.getElementById('editFrontTitle');
    const editBackTitleInput = document.getElementById('editBackTitle');
    const editFrontTextInput = document.getElementById('editFrontText');
    const editBackTextInput = document.getElementById('editBackText');
    const editFrontImageInput = document.getElementById('editFrontImage');
    const editBackImageInput = document.getElementById('editBackImage');
    const editFrontAudioInput = document.getElementById('editFrontAudio');
    const editBackAudioInput = document.getElementById('editBackAudio');
    const saveEditBtn = document.getElementById('saveEditBtn');
    const currentCardNumberElement = document.getElementById('currentCardNumber');
    const totalCardsElement = document.getElementById('totalCards');
    const categoriesContainer = document.getElementById('categoriesContainer');
    const currentStackNameElement = document.getElementById('currentStackName');
    const removeStackBtn = document.getElementById('removeStackBtn');
    const moveUpBtn = document.getElementById('moveUpBtn');
    const moveDownBtn = document.getElementById('moveDownBtn');
    const removeFrontImageBtn = document.getElementById('removeFrontImage');
    const removeBackImageBtn = document.getElementById('removeBackImage');
    const frontTitleFontSelect = document.getElementById('frontTitleFont');
    const frontTextFontSelect = document.getElementById('frontTextFont');
    const backTitleFontSelect = document.getElementById('backTitleFont');
    const backTextFontSelect = document.getElementById('backTextFont');

    const timerDisplay = document.getElementById('timer');
    const startButton = document.getElementById('startButton');
    const pauseResumeButton = document.getElementById('pauseResumeButton');
    const resetButton = document.getElementById('resetButton');
    const timerCircle = document.querySelector('.timer-circle');
    const presetButtons = document.querySelectorAll('.preset-button');
    const minutesInput = document.getElementById('minutesInput');
    const secondsInput = document.getElementById('secondsInput');
    const TimerModal = document.getElementById('TimerModal');
    const showTimerModalButton = document.getElementById('showTimerModalButton');
    const notification = document.getElementById('notification');


// --> TIMER MODAL


    startButton.addEventListener('click', startTimer);
    pauseResumeButton.addEventListener('click', togglePause);
    resetButton.addEventListener('click', resetTimer);
    presetButtons.forEach(button => {
      button.addEventListener('click', () => {
        totalTime = parseInt(button.dataset.time);
        timeLeft = totalTime;
        updateTimerDisplay(timeLeft);
        updateCircleProgress(timeLeft);
      });
    });

    minutesInput.addEventListener('change', updateCustomTime);
    secondsInput.addEventListener('change', updateCustomTime);

    showTimerModalButton.addEventListener('click', () => {
      TimerModal.classList.toggle('show');
    });

    function updateCustomTime() {
      const minutes = parseInt(minutesInput.value) || 0;
      const seconds = parseInt(secondsInput.value) || 0;
      totalTime = minutes * 60 + seconds;
      timeLeft = totalTime;
      updateTimerDisplay(timeLeft);
      updateCircleProgress(timeLeft);
    }

    function startTimer() {
      if (!totalTime) return;
      clearInterval(countdown);
      
      isPaused = false;
      isActive = true;
      updateTimerDisplay(timeLeft);
      updateCircleProgress(timeLeft);
      pauseResumeButton.innerHTML = "&#10074;&#10074;";
      TimerModal.classList.add('show');
      showNotification("Timer Started");
      
      countdown = setInterval(() => {
        if (!isPaused) {
          timeLeft--;
          updateTimerDisplay(timeLeft);
          updateCircleProgress(timeLeft);
          
          if (timeLeft <= 0) {
            clearInterval(countdown);
            isActive = false;
            showNotification("Timer Finished!");
          }
        }
      }, 1000);
    }

function togglePause() {
      isPaused = !isPaused;
      pauseResumeButton.innerHTML = isPaused ? "&#9658;" : "&#10074;&#10074;";
      showNotification(isPaused ? "Timer Paused" : "Timer Resumed");
    }

    function resetTimer() {
      clearInterval(countdown);
      timeLeft = totalTime;
      isPaused = false;
      isActive = false;
      updateTimerDisplay(timeLeft);
      updateCircleProgress(timeLeft);
      pauseResumeButton.innerHTML = "&#10074;&#10074;";
      showNotification("Timer Reset");
    }

    function updateTimerDisplay(seconds) {
      const displayMinutes = Math.floor(seconds / 60);
      const displaySeconds = seconds % 60;
      const formattedTime = `${padZero(displayMinutes)}:${padZero(displaySeconds)}`;
      timerDisplay.innerHTML = `${formattedTime}<span class="timer-unit">sec</span>`;
    }

    function padZero(num) {
      return num.toString().padStart(2, '0');
    }

    function updateCircleProgress(timeLeft) {
      const progress = (timeLeft / totalTime) * 360;
      timerCircle.style.background = `conic-gradient(#ff3b7f ${360 - progress}deg, #f0f0f0 ${360 - progress}deg)`;
    }

    function showNotification(message) {
      notification.textContent = message;
      notification.classList.add('show');
      setTimeout(() => {
        notification.classList.remove('show');
      }, 2000);
    }
    




// -->Capturar Imagen

document.getElementById('saveFrontAsJPG').addEventListener('click', function() {
    console.log("Botón de guardar como JPG fue clickeado.");

    // Selecciona el frente de la tarjeta  
    const cardSide = document.querySelector('.flashcard-front'); // Selecciona el div que contiene el frente
    if (cardSide) {
        console.log("Elemento a capturar encontrado:", cardSide);

        html2canvas(cardSide).then(function(canvas) {
            console.log("Canvas creado exitosamente.");

            const imgData = canvas.toDataURL('image/jpeg');
            console.log("Imagen convertida a formato JPG.");

            const link = document.createElement('a');
            link.href = imgData;
            link.download = 'tarjeta-frente.jpg';
            console.log("Enlace para descargar la imagen creado.");

            link.click();
            console.log("Simulación de clic en el enlace realizada, la descarga debería comenzar.");
        }).catch(function(error) {
            console.error("Error al crear el canvas:", error);
        });
    } else {
        console.error("El elemento .flashcard-front no fue encontrado.");
    }
});


document.getElementById('saveBackAsJPG').addEventListener('click', function() {
    console.log("Botón de guardar como JPG fue clickeado.");

    // Selecciona el frente de la tarjeta  
    const cardSide = document.querySelector('.flashcard-back'); // Selecciona el div que contiene el frente
    if (cardSide) {
        console.log("Elemento a capturar encontrado:", cardSide);

        html2canvas(cardSide).then(function(canvas) {
            console.log("Canvas creado exitosamente.");

            const imgData = canvas.toDataURL('image/jpeg');
            console.log("Imagen convertida a formato JPG.");

            const link = document.createElement('a');
            link.href = imgData;
            link.download = 'tarjeta-frente.jpg';
            console.log("Enlace para descargar la imagen creado.");

            link.click();
            console.log("Simulación de clic en el enlace realizada, la descarga debería comenzar.");
        }).catch(function(error) {
            console.error("Error al crear el canvas:", error);
        });
    } else {
        console.error("El elemento .flashcard-front no fue encontrado.");
    }
});






// --> Animaciones Working

// --> La funcion Update Card es la que se encarga de mostrar el contenido de las tarjetitas


function updateCard() {
    if (flashcardStacks[currentStack] && flashcardStacks[currentStack].length > 0) {
        const currentCard = flashcardStacks[currentStack][currentCardIndex];
        const flashcardElement = document.getElementById('flashcard');

        // Añadir clase de salida
        flashcardElement.classList.add('flashcard-leaving');

        // Esperar la transición de salida
        setTimeout(() => {
            // Actualizar el contenido de la tarjeta
            frontCardTitleElement.textContent = currentCard.frontTitle;
            backCardTitleElement.textContent = currentCard.backTitle;
            frontTextElement.textContent = currentCard.frontText;
            backTextElement.textContent = currentCard.backText;
            flashcardElement.classList.remove('flipped');

// Actualizar el contenido de texto de la tarjeta con el contenido de Quill
            document.querySelector('.flashcard-front .card-text').innerHTML = currentCard.qfrontText || '';
            document.querySelector('.flashcard-back .card-text').innerHTML = currentCard.qbackText || '';

console.log('qfrontText:', currentCard.qfrontText);
console.log('qbackText:', currentCard.qbackText);	
            
            // Aquí es donde se aplica el color específico de la tarjeta seleccionada
        if (currentCard.color.startsWith('#')) {
            // Color sólido
            document.querySelector('.flashcard-front').style.backgroundColor = currentCard.color;
            document.querySelector('.flashcard-back').style.backgroundColor = currentCard.color;
        } else if (currentCard.color.startsWith('gradient')) {
            // Gradiente
            const gradientStyle = window.getComputedStyle(document.querySelector(`[data-color="${currentCard.color}"]`)).backgroundImage;
            document.querySelector('.flashcard-front').style.backgroundImage = gradientStyle;
            document.querySelector('.flashcard-back').style.backgroundImage = gradientStyle;
        } else if (currentCard.color.startsWith('paper')) {
            // Textura
            const paperStyle = window.getComputedStyle(document.querySelector(`[data-color="${currentCard.color}"]`)).cssText;
            document.querySelector('.flashcard-front').style.cssText = paperStyle;
            document.querySelector('.flashcard-back').style.cssText = paperStyle;
        }

            frontCardTitleElement.style.fontFamily = currentCard.frontTitleFont;
            frontTextElement.style.fontFamily = currentCard.frontTextFont;
            backCardTitleElement.style.fontFamily = currentCard.backTitleFont;
            backTextElement.style.fontFamily = currentCard.backTextFont;

            if (currentCard.frontImage) {
                frontCardImage.src = currentCard.frontImage;
                frontCardImage.style.display = 'block';
            } else {
                frontCardImage.style.display = 'none';
            }

            if (currentCard.backImage) {
                backCardImage.src = currentCard.backImage;
                backCardImage.style.display = 'block';
            } else {
                backCardImage.style.display = 'none';
            }

          
            currentCardNumberElement.textContent = currentCardIndex + 1;
            totalCardsElement.textContent = flashcardStacks[currentStack].length;

            // Remover la clase de salida y añadir la clase de entrada
            flashcardElement.classList.remove('flashcard-leaving');
            flashcardElement.classList.add('flashcard-entering');

            // Después de un breve tiempo, remover la clase de entrada
            setTimeout(() => {
                flashcardElement.classList.remove('flashcard-entering');
            }, 50); // Puedes ajustar el tiempo para una transición más suave
        }, 500); // Debe coincidir con la duración de la transición en CSS
    } else {
        // Si la pila actual está vacía o no existe
        frontCardTitleElement.textContent = "No Cards";
        backCardTitleElement.textContent = "No Cards";
        frontTextElement.textContent = "This stack is empty. Add some cards!😃 ";
        backTextElement.textContent = "This stack is empty. Add some cards!😃 ";
        currentCardNumberElement.textContent = "0";
        totalCardsElement.textContent = "0";
    }

    updateMiniatures();
    currentStackNameElement.textContent = currentStack;
}



// --> Cargar y Guardar de la Memoria Local Working 

    function saveToLocalStorage() {
      localStorage.setItem('flashcardStacks', JSON.stringify(flashcardStacks));
      showSaveIndicator();
    }

    function loadFromLocalStorage() {
      const savedStacks = localStorage.getItem('flashcardStacks');
      if (savedStacks) {
        flashcardStacks = JSON.parse(savedStacks);
        updateCard();
        updateCategories();
      }
    }

    function showSaveIndicator() {
      saveIndicator.classList.add('show');
      setTimeout(() => {
        saveIndicator.classList.remove('show');
      }, 2000);
    }


// Función para mostrar el indicador de guardado de nuevo orden //CHECK CODE

function showReorderIndicator() {
  const reorderIndicator = document.createElement('div');
  reorderIndicator.textContent = 'Changes saved';
  reorderIndicator.className = 'save-indicator reorder-indicator';
  document.body.appendChild(reorderIndicator);

  reorderIndicator.classList.add('show');
  setTimeout(() => {
    reorderIndicator.classList.remove('show');
    setTimeout(() => {
      document.body.removeChild(reorderIndicator);
    }, 300); // Tiempo para la animación de desvanecimiento
  }, 2000);
}


// --> Miniature Sorting


// Función para actualizar las miniaturas
function updateMiniatures() {
  console.log('Actualizando miniaturas');
  miniatureContainer.innerHTML = '';
  
  // Añadir la miniatura "Nueva Tarjeta"
  const newCardMiniature = document.createElement('div');
  newCardMiniature.className = 'miniature-card new-card-miniature';
  newCardMiniature.innerHTML = '+';
  newCardMiniature.onclick = openNewCardModal;
  miniatureContainer.appendChild(newCardMiniature);

  if (flashcardStacks[currentStack]) {
    flashcardStacks[currentStack].forEach((card, index) => {
      const miniature = document.createElement('div');
      miniature.className = 'miniature-card';
      miniature.style.backgroundColor = card.color;
      miniature.textContent = card.frontTitle;
      miniature.dataset.id = index.toString(); // Añadir un identificador único
      miniature.onclick = () => {
        currentCardIndex = index;
        updateCard();
      };

      const actions = document.createElement('div');
      actions.className = 'miniature-actions';
      
      const editBtn = document.createElement('button');
      editBtn.textContent = 'Edit';
      editBtn.onclick = (e) => {
        e.stopPropagation();
        openEditModal(index);
      };

      const deleteBtn = document.createElement('button');
      deleteBtn.textContent = 'Delete';
      deleteBtn.onclick = (e) => {
        e.stopPropagation();
        deleteCard(index);
      };

      actions.appendChild(editBtn);
      actions.appendChild(deleteBtn);
      miniature.appendChild(actions);
      miniatureContainer.appendChild(miniature);
    });

  } else {
    // Mostrar un mensaje cuando el stack está vacío
    const emptyMessage = document.createElement('div');
    emptyMessage.textContent = 'Stack is empty. Add some cards 😃.';
    miniatureContainer.appendChild(emptyMessage);  
  }

  // Inicializar Sortable después de añadir las miniaturas
  initializeSortable();
}

// Función para inicializar Sortable
function initializeSortable() {
  console.log('Inicializando Sortable');
  new Sortable(miniatureContainer, {
    animation: 200,
    ghostClass: 'sortable-ghost',
    filter: '.new-card-miniature', // Evitar que la miniatura "Nueva Tarjeta" sea arrastrable
    draggable: '.miniature-card:not(.new-card-miniature)', // Hacer arrastrables todas las miniaturas excepto .new-card-miniature
    onEnd: function(evt) {
      console.log('Orden de miniaturas cambiado');
      saveNewOrder();
    }
  });
}

// Función para guardar el nuevo orden
function saveNewOrder() {
  const miniatures = Array.from(miniatureContainer.querySelectorAll('.miniature-card:not(.new-card-miniature)'));
  const newOrder = miniatures.map(miniature => parseInt(miniature.dataset.id));
  
  // Reordenar el array de tarjetas en el stack actual
  flashcardStacks[currentStack] = newOrder.map(index => flashcardStacks[currentStack][index]);
  
  console.log('Nuevo orden guardado:', newOrder);
  
  // Guardar el nuevo orden en localStorage
  saveToLocalStorage();
}

// Función para guardar en localStorage
function saveToLocalStorage() {
  console.log('Guardando en localStorage...');
  localStorage.setItem('flashcardStacks', JSON.stringify(flashcardStacks));
  console.log('Guardado en localStorage');
  
  // Mostrar el indicador de reordenamiento (o notificación)
  showReorderIndicator();
}

// Función para cargar los stacks de flashcards
function loadFlashcardStacks() {
  const stacksData = JSON.parse(localStorage.getItem('flashcardStacks'));
  if (stacksData) {
    flashcardStacks = stacksData;
    console.log('Stacks cargados desde localStorage:', flashcardStacks);
  } else {
    flashcardStacks = {}; // Inicializa vacío si no hay datos
    console.log('No se encontraron stacks en localStorage. Inicializando vacío.');
  }
}



//---------- Miniature Sorting END  <---------

// --> Custom Edit button y Codigo del Toast Working
 
document.addEventListener('DOMContentLoaded', function() {
    const customEditButton = document.getElementById('customEditButton');
    const toast = document.getElementById('customToast');
    const toastMessage = document.getElementById('toastMessage');
    const closeToastBtn = document.querySelector('.toast-close-btn');

    // Función para mostrar el toast con un mensaje
    function showToast(message) {
        toastMessage.textContent = message;
        toast.classList.add('show');
        setTimeout(() => {
            toast.classList.remove('show');
        }, 3000); // El toast se oculta después de 3 segundos
    }

    // Cerrar el toast al hacer clic en el botón de cerrar
    //closeToastBtn.onclick = function() {
      //  toast.classList.remove('show');
    //}

    customEditButton.onclick = function() {
        // Verifica si flashcardStacks y currentStack están definidos
        if (typeof flashcardStacks === 'undefined' || typeof currentStack === 'undefined') {
            showToast("No card stacks available. Please check your stack settings.");
            return;
        }

        // Verifica si el stack actual es válido
        const currentCards = flashcardStacks[currentStack];
        if (!currentCards) {
            showToast("Current Stack has no Cards, Pick a Card to edit.");
            return;
        }

        // Obtén el índice actual de la tarjeta (resta 1 para convertirlo a un índice basado en cero)
        const currentCardIndex = parseInt(document.getElementById('currentCardNumber').textContent) - 1;
        const totalCards = currentCards.length;

        // Verifica si el índice es válido
        if (currentCardIndex < 0 || currentCardIndex >= totalCards) {
            showToast("No card to edit.");
        } else {
            // Abre el modal para el índice de la tarjeta actual
            openEditModal(currentCardIndex);
        }
    };
});

// Tiempo de animacion del Toast

setTimeout(() => {
    toast.classList.remove('show');
}, 4000); // El toast se oculta después de 3 segundos


// --> Añadir Tarjeta y Crear nuevo Stack Working


    function createNewStack(stackName) {
      if (!flashcardStacks[stackName]) {
        flashcardStacks[stackName] = [];
        saveToLocalStorage();
        updateCategories();
      }
    }

// --> Cargar y Guardar de la Memoria Local Working 

    function saveToLocalStorage() {
      localStorage.setItem('flashcardStacks', JSON.stringify(flashcardStacks));
      showSaveIndicator();
    }

    function loadFromLocalStorage() {
      const savedStacks = localStorage.getItem('flashcardStacks');
      if (savedStacks) {
        flashcardStacks = JSON.parse(savedStacks);
        updateCard();
        updateCategories();
      }
    }

    function showSaveIndicator() {
      saveIndicator.classList.add('show');
      setTimeout(() => {
        saveIndicator.classList.remove('show');
      }, 2000);
    }

// --> Guardar Tarjeta Editada Working

    function saveCard() {
      if (!flashcardStacks[currentStack]) {
        flashcardStacks[currentStack] = [];
      }
      if (currentCardIndex === flashcardStacks[currentStack].length) {
        // This is a new card
        flashcardStacks[currentStack].push({});
      }
      const currentCard = flashcardStacks[currentStack][currentCardIndex];
      currentCard.frontTitle = editFrontTitleInput.value;
      currentCard.backTitle = editBackTitleInput.value;
      currentCard.frontText = editFrontTextInput.value;
      currentCard.backText = editBackTextInput.value;

      currentCard.qfrontText = quillFront.root.innerHTML;  // Cambiado a qfrontText
      currentCard.qbackText = quillBack.root.innerHTML;    // Cambiado a qbackText	

      currentCard.color = selectedColor;
      currentCard.frontTitleFont = frontTitleFontSelect.value;
      currentCard.frontTextFont = frontTextFontSelect.value;
      currentCard.backTitleFont = backTitleFontSelect.value;
      currentCard.backTextFont = backTextFontSelect.value;


      handleFileInput(editFrontImageInput, 'frontImage', currentCard);
      handleFileInput(editBackImageInput, 'backImage', currentCard);
      
      updateCard();
      saveToLocalStorage();
      closeEditModal();
      updateCategories();
    }

    function handleFileInput(input, property, card) {
      if (input.files.length > 0) {
        const file = input.files[0];
        const reader = new FileReader();
        reader.onload = function(e) {
          card[property] = e.target.result;
          updateCard();
        };
        if (property.includes('Image')) {
          reader.readAsDataURL(file);
        } else if (property.includes('Audio')) {
          reader.readAsArrayBuffer(file);
        }
      }
    }

// --> Remove Media Modal Working

document.addEventListener('click', function(event) {
    // Quitar imagen frontal
    if (event.target.id === 'removeFrontImage') {
        var card = event.target.closest('.card');
        var frontImage = card.querySelector('.front img');
        if (frontImage) {
            frontImage.remove();
        }
    }

    
    // Quitar imagen trasera
    if (event.target.id === 'removeBackImage') {
        var card = event.target.closest('.card');
        var backImage = card.querySelector('.back img');
        if (backImage) {
            backImage.remove();
        }
    }

});

// --> Actualizar despues de remover Media Working

function updateCardDisplay() {
    const currentCard = flashcardStacks[currentStack][currentCardIndex];

    // Actualizar la imagen frontal y trasera en la interfaz
    const frontImageElement = document.querySelector('.card-front img');
    const backImageElement = document.querySelector('.card-back img');
    
    if (frontImageElement) {
        frontImageElement.src = currentCard.frontImage || '';
        if (!currentCard.frontImage) frontImageElement.remove();
    }

    if (backImageElement) {
        backImageElement.src = currentCard.backImage || '';
        if (!currentCard.backImage) backImageElement.remove();
    }

    
    // Si es necesario, puedes agregar más código para refrescar otros elementos de la tarjeta
}        

// --> Borrar Tarjeta Working

    function deleteCard(index) {
      if (confirm('Are you sure you want to delete this card?')) {
        flashcardStacks[currentStack].splice(index, 1);
        if (currentCardIndex >= flashcardStacks[currentStack].length) {
          currentCardIndex = flashcardStacks[currentStack].length - 1;
        }
        updateCard();
        saveToLocalStorage();
        updateCategories();
      }
    }





// --> Funcion de Sortear y Renombrar Categorias Working





// Evento que se ejecuta cuando el DOM está completamente cargado
document.addEventListener('DOMContentLoaded', function() {
  loadFlashcardStacks();
  updateCategories();
  if (Object.keys(flashcardStacks).length > 0) {
    currentStack = Object.keys(flashcardStacks)[0];
  }
  updateMiniatures();
  updateCard();
});

function updateCategories() {
  categoriesContainer.innerHTML = '';
  
  Object.keys(flashcardStacks).forEach((stackName, index) => {
    const category = document.createElement('div');
    category.className = 'category';
    category.innerHTML = `
      <div class="category-icon drag-handle">${stackName[0].toUpperCase()}</div>
      <span class="category-name">${stackName}</span>
      <span class="category-count">${flashcardStacks[stackName].length} cards</span>
      <span class="category-remove">&#10005;</span>
    `;

    // Hacer la categoría editable con doble clic
    const categoryNameElement = category.querySelector('.category-name');
    categoryNameElement.ondblclick = function () {
      isEditingCategoryName = true;
      console.log('Iniciando edición de categoría');  // Log para depuración
      const input = document.createElement('input');
      input.type = 'text';
      input.value = stackName;
      input.className = 'edit-category-input';
      categoryNameElement.innerHTML = '';
      categoryNameElement.appendChild(input);
      input.select();

      input.onblur = function () {
        isEditingCategoryName = false;
        console.log('Finalizando edición de categoría');  // Log para depuración
        saveNewCategoryName(stackName, input.value);
      };
      input.onkeydown = function (e) {
        if (e.key === 'Enter') {
          isEditingCategoryName = false;
          console.log('Finalizando edición de categoría (Enter)');  // Log para depuración
          saveNewCategoryName(stackName, input.value);
        }
        e.stopPropagation();  // Evitar que el evento se propague
      };
    };

    category.onclick = (e) => {
      // Evitar cambiar de categoría cuando se hace clic en el icono de arrastre
      if (!e.target.classList.contains('drag-handle')) {
        currentStack = stackName;
        currentCardIndex = 0;
        updateCard();
      }
    };

    categoriesContainer.appendChild(category);
  });

  // Inicializar Sortable.js en el contenedor de categorías
  new Sortable(categoriesContainer, {
    animation: 150,
    handle: '.drag-handle', // Especifica el selector para el manejador de arrastre
    ghostClass: 'sortable-ghost',
    onEnd: function (evt) {
      const newOrder = Array.from(categoriesContainer.children).map(
        category => category.querySelector('.category-name').textContent
      );
      const reorderedStacks = {};
      newOrder.forEach(stackName => {
        reorderedStacks[stackName] = flashcardStacks[stackName];
      });
      flashcardStacks = reorderedStacks;
      saveToLocalStorage(); // Guardar cambios en el orden
    }
  });
}

function saveNewCategoryName(oldName, newName) {
  if (newName && newName !== oldName) {
    if (!flashcardStacks[newName]) {
      flashcardStacks[newName] = flashcardStacks[oldName];
      delete flashcardStacks[oldName];
      updateCategories();
      saveToLocalStorage(); // Guardar cambios en el nombre
    } else {
      alert('Category name already exists.');
    }
  } else {
    updateCategories();
  }
}

function saveToLocalStorage() {
  // Guardar los datos en el almacenamiento local
  localStorage.setItem('flashcardStacks', JSON.stringify(flashcardStacks));
  console.log('Changes saved to localStorage'); // Log para depuración

  // Mostrar notificación de guardado en el almacenamiento local
  const notification = document.createElement('div');
  notification.className = 'SaveCategorienotification';
  notification.textContent = 'Changes Saved!';
  document.body.appendChild(notification);
  
  // Mostrar la notificación con animación
  requestAnimationFrame(() => {
    notification.style.opacity = '1';
  });

  // Ocultar la notificación después de 2 segundos
  setTimeout(() => {
    notification.style.opacity = '0';
    setTimeout(() => {
      document.body.removeChild(notification);
    }, 2000); // Asegura que la notificación se elimine después de la animación
  }, 2000);
}








// Nuevo evento para manejar la navegación por teclado

document.addEventListener('keydown', function(e) {
  console.log('Tecla presionada:', e.key, 'isEditingCategoryName:', isEditingCategoryName);  // Log para depuración
  if (!isEditingCategoryName) {
    if (e.key === 'ArrowRight') {
      e.preventDefault();  // Prevenir el comportamiento predeterminado
      nextCard();
    } else if (e.key === 'ArrowLeft') {
      e.preventDefault();  // Prevenir el comportamiento predeterminado
      previousCard();
    }
  }
});







// --> New Card Modal Working

function openNewCardModal() {
   editFrontTitleInput.value = '';
   editBackTitleInput.value = '';
   editFrontTextInput.value = '';
   editBackTextInput.value = '';
  editFrontImageInput.value = '';
  editBackImageInput.value = '';
   selectedColor = '#FFFFFF';
   frontTitleFontSelect.value = 'Raleway';
   frontTextFontSelect.value = 'Montserrat';
   backTitleFontSelect.value = 'Raleway';
   backTextFontSelect.value = 'Montserrat';

 
quillFront.setContents([{ insert: '\n' }]); // Resetea el editor frontal
quillBack.setContents([{ insert: '\n' }]); // Resetea el editor trasero


   currentCardIndex = flashcardStacks[currentStack] ? flashcardStacks[currentStack].length : 0;
   editCardTitle.textContent = "New Card";
   editCardModal.style.display = 'block';
   isModalOpen = true; // Establecer a true cuando se abre el modal
}

function closeNewCardModal() {
   editCardModal.style.display = 'none';
   isModalOpen = false; // Establecer a false cuando se cierra el modal
}

closeModal.addEventListener('click', closeNewCardModal);

saveEditBtn.addEventListener('click', () => {
   saveCard(); // Ahora usamos la función saveCard()
   closeNewCardModal(); // Asegurarse de que isModalOpen se establezca a false al guardar
});

window.onclick = function(event) {
   if (event.target == editCardModal) {
      closeNewCardModal();
   }
};






// --> Edit modal Working 

// Variable global para controlar si el modal está abierto
let isModalOpen = false;

function openEditModal(index) {
      currentCardIndex = index;
      const currentCard = flashcardStacks[currentStack][currentCardIndex];
      editFrontTitleInput.value = currentCard.frontTitle;
      editBackTitleInput.value = currentCard.backTitle;
      editFrontTextInput.value = currentCard.frontText;
      editBackTextInput.value = currentCard.backText;
      selectedColor = currentCard.color;
      frontTitleFontSelect.value = currentCard.frontTitleFont;
      frontTextFontSelect.value = currentCard.frontTextFont;
      backTitleFontSelect.value = currentCard.backTitleFont;
      backTextFontSelect.value = currentCard.backTextFont;

      // Asignar el contenido de Quill a los editores de Quill
    quillFront.root.innerHTML = currentCard.qfrontText || '';
    quillBack.root.innerHTML = currentCard.qbackText || '';

    // Configurar las fuentes seleccionadas para los textos de Quill
    quillFront.format('font', currentCard.frontTextFont || 'Montserrat');
    quillBack.format('font', currentCard.backTextFont || 'Montserrat');

      editCardTitle.textContent = "Edit Card";
      editCardModal.style.display = 'block';
      
          // Conectar los botones de remover imagen y audio
    document.getElementById('removeFrontImage').onclick = function() {
        currentCard.frontImage = ''; // Remover imagen frontal
        updateCardDisplay(); // Actualizar la tarjeta en el display
    };
    
    document.getElementById('removeBackImage').onclick = function() {
        currentCard.backImage = ''; // Remover imagen trasera
        updateCardDisplay(); // Actualizar la tarjeta en el display
    };

        
    isModalOpen = true; // Establecer a true cuando se abre el modal
    console.log('Modal opened'); // Diagnóstico
    }

// --> Acordeon Working 


document.addEventListener('DOMContentLoaded', function() {
    const accordionHeaders = document.querySelectorAll('.accordion-header');
    const editCardModal = document.getElementById('editCardModal');

    function resetAccordion() {
        accordionHeaders.forEach(header => {
            const content = header.nextElementSibling;
            header.classList.remove('active');
            content.classList.remove('active');
            content.style.maxHeight = null;
        });

        // Abrir el primer panel por defecto
        const firstAccordionHeader = accordionHeaders[0];
        const firstAccordionContent = firstAccordionHeader.nextElementSibling;
        firstAccordionHeader.classList.add('active');
        firstAccordionContent.classList.add('active');
        firstAccordionContent.style.maxHeight = firstAccordionContent.scrollHeight + "px";
    }

    accordionHeaders.forEach(header => {
        header.addEventListener('click', function() {
            // Cerrar todos los paneles excepto el que se clicó
            accordionHeaders.forEach(h => {
                if (h !== this) {
                    h.classList.remove('active');
                    const content = h.nextElementSibling;
                    content.classList.remove('active');
                    content.style.maxHeight = null;
                }
            });

            // Abrir/cerrar el panel actual
            this.classList.toggle('active');
            const content = this.nextElementSibling;
            if (content.classList.contains('active')) {
                content.classList.remove('active');
                content.style.maxHeight = null;
            } else {
                content.classList.add('active');
                content.style.maxHeight = content.scrollHeight + "px";
            }
        });
    });

    // Resetea el acordeón cada vez que se abre el modal
    editCardModal.addEventListener('show.bs.modal', resetAccordion);
});







// --> Close Edit Modal

    function closeEditModal() {
  editCardModal.style.display = 'none';
  isModalOpen = false; // Establecer a false cuando se cierra el modal
  console.log('Modal closed'); // Diagnóstico
}

closeModal.addEventListener('click', closeEditModal);
saveEditBtn.addEventListener('click', () => {
  saveCard();
  closeEditModal(); // Asegurarse de que isModalOpen se establezca a false al guardar
});

window.onclick = function(event) {
  if (event.target == editCardModal) {
    closeEditModal();
  }
};






// --> Navegacion Por Teclado y Flip Animation Working

// Función para manejar la navegación y el efecto flip
function navigateCard(direction) {
  if (isModalOpen) return; // Si el modal está abierto, no hacer nada
  if (flashcardStacks[currentStack] && flashcardStacks[currentStack].length > 0) {
    flashcardElement.classList.remove('flipped');
    setTimeout(() => {
      if (direction === 'prev') {
        currentCardIndex = (currentCardIndex - 1 + flashcardStacks[currentStack].length) % flashcardStacks[currentStack].length;
      } else if (direction === 'next') {
        currentCardIndex = (currentCardIndex + 1) % flashcardStacks[currentStack].length;
      }
      updateCard();
    }, 300);
  }
}

// Manejadores de eventos para los botones de navegación
prevBtn.addEventListener('click', () => {
  if (!isModalOpen) navigateCard('prev');
});

nextBtn.addEventListener('click', () => {
  if (!isModalOpen) navigateCard('next');
});


// ---> Manejar la navegación y el flip con el teclado

document.addEventListener('keydown', (event) => {
  if (isModalOpen) return; // Si el modal está abierto, no hacer nada
  if (event.key === 'ArrowLeft') {
    navigateCard('prev');
  } else if (event.key === 'ArrowRight') {
    navigateCard('next');
  } else if (event.key === ' ') {
    event.preventDefault();
    flashcardElement.classList.toggle('flipped');
  }
});

// Manejador del flip al hacer clic
flashcardElement.addEventListener('click', () => {
  if (!isModalOpen) {
    flashcardElement.classList.toggle('flipped');
  }
});

// --> Color Selection

 
  colorOptions.forEach(option => {
      option.addEventListener('click', (e) => {
        selectedColor = e.target.getAttribute('data-color');
        document.querySelector('.flashcard-front').style.backgroundColor = selectedColor;
        document.querySelector('.flashcard-back').style.backgroundColor = selectedColor;
      });
    });


// --> Abre y Cierra el Modal About Working

document.addEventListener('DOMContentLoaded', function() {
    var modal = document.getElementById('aboutModal');
    var btn = document.getElementById('openAboutModal');
    var span = document.getElementsByClassName('close')[0];

    // Abre el modal
    btn.onclick = function() {
        modal.style.display = 'block';
    }

    // Cierra el modal cuando se hace clic en la "x"
    span.onclick = function() {
        modal.style.display = 'none';
    }

    // Cierra el modal cuando se hace clic fuera del contenido
    window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = 'none';
        }
    }
});


// --> New, Save, Remove, Export, Import Working

    newStackBtn.addEventListener('click', () => {
      const stackName = prompt("Enter a name for the new stack:");
      if (stackName) {
        createNewStack(stackName);
        currentStack = stackName;
        currentCardIndex = 0;
        updateCard();
      }
    });

    saveStackBtn.addEventListener('click', () => {
      saveToLocalStorage();
    });

    removeStackBtn.addEventListener('click', () => {
      removeStack(currentStack);
    });

    function removeStack(stackName) {
      if (confirm(`Are you sure you want to remove the "${stackName}" stack?`)) {
        delete flashcardStacks[stackName];
        if (currentStack === stackName) {
          currentStack = Object.keys(flashcardStacks)[0] || 'default';
          currentCardIndex = 0;
        }
        updateCard();
        saveToLocalStorage();
        updateCategories();
      }
    }

    exportStackBtn.addEventListener('click', () => {
      const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(flashcardStacks[currentStack]));
      const downloadAnchorNode = document.createElement('a');
      downloadAnchorNode.setAttribute("href", dataStr);
      downloadAnchorNode.setAttribute("download", currentStack + "_flashcards.json");
      document.body.appendChild(downloadAnchorNode);
      downloadAnchorNode.click();
      downloadAnchorNode.remove();
    });

    importStackBtn.addEventListener('click', () => {
      importStackInput.click();
    });

    importStackInput.addEventListener('change', (event) => {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          try {
            const importedStack = JSON.parse(e.target.result);
            const stackName = prompt("Enter a name for the imported stack:");
            if (stackName) {
              flashcardStacks[stackName] = importedStack;
              createNewStack(stackName);
              currentStack = stackName;
              currentCardIndex = 0;
              updateCard();
              saveToLocalStorage();
              updateCategories();
            }
          } catch (error) {
            console.error("Error importing stack:", error);
            alert("Error importing stack. Please make sure the file is a valid JSON.");
          }
        };
        reader.readAsText(file);
      }
    });

    loadFromLocalStorage();
    updateCard();
    updateCategories();


//--------------->>>> QUILL CODE

  const fonts = [
    'raleway',
    'montserrat',
    'poppins',
    'opensans',
    'sofia',
    'lato',
    'roboto'
  ];

  const fontSizes = ['8px', '9px', '10px', '11px', '12px', '14px', '16px', '18px', '20px', '24px', '30px', '36px', '48px', '60px', '72px'];

  const toolbarOptions = [
    [{ 'header': [1, 2, 3, 4, 5, 6, false] }],
    [{ 'font': fonts }],
    [{ 'size': fontSizes }],
    ['bold', 'italic', 'underline', 'strike'],
    [{ 'color': [] }, { 'background': [] }],
    [{ 'script': 'sub'}, { 'script': 'super' }],
    [{ 'header': 1 }, { 'header': 2 }],
    [{ 'list': 'ordered'}, { 'list': 'bullet' }],
    [{ 'indent': '-1'}, { 'indent': '+1' }],
    [{ 'direction': 'rtl' }],
    [{ 'align': [] }],
    ['blockquote', 'code-block'],
    ['link', 'image', 'video'],
    ['clean']
  ];

  // Configuración personalizada de fuentes
  var Font = Quill.import('formats/font');
  Font.whitelist = fonts;
  Quill.register(Font, true);

  // Configuración personalizada de tamaños
  var Size = Quill.import('attributors/style/size');
  Size.whitelist = fontSizes;
  Quill.register(Size, true);


   // Inicializar Quill para el lado frontal
    var quillFront = new Quill('#editFrontTextEditor', {
        modules: {
      toolbar: toolbarOptions
    },
    theme: 'snow'
    });

    // Inicializar Quill para el lado trasero
    var quillBack = new Quill('#editBackTextEditor', {
          modules: {
      toolbar: toolbarOptions
    },
    theme: 'snow'
    });


  const preview = document.getElementById('preview');

  quill.on('text-change', function() {
    preview.innerHTML = quill.root.innerHTML;
  });

  // Personalizar el selector de fuentes
  const fontSelector = document.querySelector('.ql-font');
  if (fontSelector) {
    fontSelector.querySelectorAll('.ql-picker-item').forEach((item, index) => {
      item.textContent = fonts[index].charAt(0).toUpperCase() + fonts[index].slice(1);
      item.dataset.value = fonts[index];
    });
    fontSelector.querySelector('.ql-picker-label').innerHTML = 'Fuente';
  }

  // Personalizar el selector de tamaños
  const sizeSelector = document.querySelector('.ql-size');
  if (sizeSelector) {
    sizeSelector.querySelectorAll('.ql-picker-item').forEach((item, index) => {
      item.textContent = fontSizes[index];
      item.dataset.value = fontSizes[index];
    });
    sizeSelector.querySelector('.ql-picker-label').innerHTML = 'Tamaño';
  }

  // Función para actualizar el tamaño de la fuente
  function updateFontSize() {
    const size = sizeSelector.querySelector('.ql-picker-label').getAttribute('data-value');
    quill.format('size', size);
  }

  // Agregar evento de cambio al selector de tamaño
  sizeSelector.addEventListener('click', function(event) {
    if (event.target && event.target.classList.contains('ql-picker-item')) {
      setTimeout(updateFontSize, 0);
    }
  });

//---------------------END-------------


  </script>
</body>
</html>