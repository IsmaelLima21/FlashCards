<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Elegant Flashcards</title>
<!-- jQuery (debe ir antes de Bootstrap) -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- Bootstrap -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
<!-- SortableJS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.js"></script>
<!--Google Font-->
<link href='https://fonts.googleapis.com/css?family=Montserrat|Sofia|Lato|Raleway' rel='stylesheet'>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<link href="https://fonts.cdnfonts.com/css/gill-sans-2" rel="stylesheet">
<!--Font Awesome-->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
<!--Animate.css-->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
</head>

<style>
  body {
    font-family: 'Raleway';
    font-size: 20px;
    background-color: #f5f5f5;
    margin: 0;
    padding: 0;
    display: flex;
    min-height: 100vh;
    color: #333;
  }
  .left-container {
    width: 380px;
    background-color: #ffffff;
    box-shadow: 2px 0 10px rgba(0,0,0,0.2);
    overflow-y: auto;
    padding: 20px;
  }
  .right-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background-color: #f9f9f9;
    padding: 30px;
    position: relative;
  }
  h1, h2 {
    color: #424242;
    text-align: center;
    margin-bottom: 20px;
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
  }
  .categories {
    margin-bottom: 20px;
    height: 160px;
    overflow-y: auto;
  }
  .category {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
    cursor: pointer;
    padding: 5px;
    border-radius: 8px;
    transition: background-color 1.0s;
  }
  .category:hover {
    background-color: #f0f0f0;
  }
  .category-icon {
    width: 24px;
    height: 24px;
    margin-right: 10px;
    background-color: #e0e0e0;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    color: #fff;
  }
  .category-name {
    font-size: 16px;
    flex-grow: 1;
  }
  
.category-count {
    margin-left: auto;
    color: #888;
    font-size: 14px;
  }

  .category-remove {
    margin-left: 10px;
    color: rgba(0,0,0,0.001);
    cursor: pointer;
    font-size: 18px;
  }
  .flashcard {
    width: 420px;
    height: 740px;
    perspective: 1000px;
    cursor: pointer;
  }
  .flashcard-inner {
    position: relative;
    width: 100%;
    height: 100%;
    text-align: center;
    transition: transform 1.0s;
    transform-style: preserve-3d;
  }
  .flashcard.flipped .flashcard-inner {
    transform: rotateY(180deg);
  }
  .flashcard-front, .flashcard-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    padding: 20px;
    box-sizing: border-box;
    border-radius: 16px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.22);
    background-color: #ffffff;
  }
  .flashcard-back {
    transform: rotateY(180deg);
  }
  .flashcard-title {
    font-size: 24px;
    font-weight: bold;
    margin-bottom: 20px;
  }
  .flashcard-description {
    font-size: 16px;
    line-height: 120%;
    color: #666;
  }
  .flashcard-controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    margin-top: 20px;
  }
  .card-number {
    font-size: 14px;
    color: #888;
  }
  .add-to-stack {
    background-color: #ff6b6b;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 20px;
    cursor: pointer;
    font-size: 14px;
  }
  .nav-button {
    background-color: transparent;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: #888;
  }

/* Pendiente Editar campos */

    input[type="text"], input[type="file"], select, textarea {
    font-family: 'Raleway';
    font-size: 12px;
    width: 100%;
    padding: 10px;
    margin: 8px 0;
    box-sizing: border-box;
    border: 1px solid #dedede;
    border-radius: 8px;
  }
  textarea {
    resize: vertical;
    min-height: 100px;
  }

  button {
    background-color: #fff;
    border: 1px solid #e8e8e8;
    color: #666;
    padding: 6px 15px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 14px;
    margin: 4px 2px;
    cursor: pointer;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    transition: background-color 0.3s;
  }
  button:hover {
    color: #666;
    background-color: #fff;
    border: 1px solid #c4c4c4;
  }
  .color-option {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    display: inline-block;
    margin: 0 5px;
    cursor: pointer;
    /*border: 1px solid #666;*/
  }
  .miniature-container {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    height: 450px;
    margin-top: 20px;
    overflow-y: auto;
  }
  .miniature-card {
    width: 80px;
    height: 130px;
    border: 1px solid #ccc;
    border-radius: 5px;
    padding: 5px;
    font-size: 12px;
    overflow: hidden;
    cursor: pointer;
    position: relative;
    background-color: #fff;
  }
  .miniature-actions {
    position: absolute;
    bottom: 5px;
    left: 5px;
    right: 5px;
    display: flex;
    justify-content: space-between;
  }
  .miniature-actions button {
    padding: 2px 5px;
    font-size: 8px;
  }

.save-indicator {
    position: absolute;
    top: 20px;
    top: 20px; /* Cambiado de right a left */
    padding: 10px;
    background-color: #ff1f4b;
    color: white;
    border-radius: 7px;
    opacity: 0;
    box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
    transition: opacity 2.0s ease;
}
  .save-indicator.show {
    opacity: 1;
  }

  .edit-card-modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    /*background-color: rgba(255,255,255,0.01);*/
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);	
    overflow-y: auto;
  }
  .edit-card-content {
    background-color: rgba(255,255,255,0.1);
    /*background-color: #fefefe;*/
    margin: 7% auto;
    padding: 30px;
    border: 1px solid #ff2954;
    width: 60%;
    max-width: 480px;
    border-radius: 12px;
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);	
    box-shadow: 0 4px 8px rgba(0, 0, 0,0.25); 
  }
  .close-modal {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: normal;
    cursor: pointer;
  }
  .close-modal:hover,
  .close-modal:focus {
    color: #ff2954;
    text-decoration: none;
    cursor: pointer;
  }
  .new-card-miniature {
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    font-weight: bold;
    color: #ff2954;
    border: 1px solid #ff2954;
    background-color: #fff;
    box-shadow: 0 2px 6px rgba(255, 41, 84,0.1); 
  }


/* Estilos del Modal */
.modal {
    display: none; /* Oculto por defecto */
    position: fixed; 
    z-index: 1000; 
    left: 0;
    top: -70px;
    width: 100%;
    height: 100%;
    overflow: auto;
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);	
    background-color: rgba(0, 0, 0, 0.0); /* Fondo oscuro con opacidad */
}

.modal-content {
    background: rgba(255, 255, 255, 0.70);
    font-size: 16px;
    font-weight: normal;
    margin: 10% auto;
    padding: 45px;
    width: 620px; 
    height: 500px;
    box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);    
    border-radius: 18px;
    border: 1px solid #ff2954;
    /*border: 1px solid rgba(255, 255, 255, 0.18);*/    
    /*overflow-y: auto;  Scroll si el contenido es demasiado grande */
}


.modal-footer {
    display: flex;
    justify-content: center;  /* Centra el botón horizontalmente */
    align-items: flex-end;    /* Coloca el botón en la parte inferior del contenedor */
    height: 100px;            /* Ajusta la altura del contenedor según sea necesario */
    position: relative;
}

.close {
    color: #aaa;
    float: right;
    font-size: 24px;
    font-weight: normal;
}

.close:hover,
.close:focus {
    color: #ff2954;
    text-decoration: none;
    cursor: pointer;
}


.btn.btn-info {
    background-color: #17a2b8;
    border-color: #17a2b8;
    color: #fff;
    padding: 10px 20px;
    font-size: 16px;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s, border-color 0.3s;
}

.btn.btn-info:hover {
    background-color: #138496;
    border-color: #117a8b;
}

.btn.btn-info:focus {
    outline: none;
    box-shadow: 0 0 5px rgba(23, 162, 184, 0.5);
}




    
    .copy {    
    padding: 6px 15px;
    margin: 4px 2px;
   border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    transition: background-color 0.3s;
  }


.custom-toast {
  visibility: hidden; /* Oculto por defecto */
  min-width: 250px; /* Ancho mínimo */
  margin-right: 20px; /* Espaciado desde el borde derecho */
  background-color: #fff; /* Fondo oscuro */
  font-size: 14px;
  color: #666; /* Texto blanco */
  text-align: center; /* Alineación del texto */
  border: 1px solid #e8e8e8;
  border-radius: 8px; /* Bordes redondeados */
  position: fixed; /* Fijo en la pantalla */
  z-index: 1000; /* Enfrente de otros elementos */
  right: 20px; /* Distancia desde el borde derecho */
  bottom: 90px; /* Distancia desde la parte inferior */
  padding: 20px; /* Espaciado interno */
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2); /* Sombra */
  transition: visibility 0.6s, opacity 0.6s linear; /* Transición suave */
  opacity: 0; /* Invisible por defecto */
}


.custom-toast.show {
  visibility: visible; /* Visible cuando se activa */
  opacity: 1; /* Opacidad completa */
}

.toast-close-btn {
  background: none;
  border: none;
  color: #fff;
  font-size: 14px;
  cursor: pointer;
  float: right;
}



.flashcard {
  perspective: 1000px;
}

.flashcard-inner {
  transition: transform 0.9s;
  transform-style: preserve-3d;
  position: relative;
}

.flashcard.flipped .flashcard-inner {
  transform: rotateY(180deg);
}



.flashcard {
    transition: transform 0.5s ease-in-out, opacity 0.5s ease-in-out;
    transform: scale(1);
    opacity: 1;
}

.flashcard-leaving {
    transform: scale(0.8);
    opacity: 0;
}

.flashcard-entering {
    transform: scale(1.2);
    opacity: 0;
}




  .color-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 5px;
    margin-top: 10px;
  }

  .color-option {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    display: inline-block;
    cursor: pointer;
    border: 1px solid #c4c4c4;
    /*border: 1px solid transparent;*/
    transition: border-color 0.5s ease;
    box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);	
  }

  .color-option:hover, .color-option.selected {
    border-color: #bababa;
  }

  .color-option[data-color="gradient-1"] {
    background: linear-gradient(to right, #ff9a9e, #fad0c4);
  }

  .color-option[data-color="gradient-2"] {
    background: linear-gradient(to right, #a1c4fd, #c2e9fb);
  }

  .color-option[data-color="gradient-3"] {
    background: linear-gradient(to right, #d4fc79, #96e6a1);
  }

  .color-option[data-color="gradient-4"] {
    background: linear-gradient(to right, #ffecd2, #fcb69f);
  }

  .color-option[data-color="gradient-5"] {
    background: linear-gradient(to right, #84fab0, #8fd3f4);
  }

  .color-option[data-color="paper-1"] {
    background-color: #fff;
    background-image: url('data:image/svg+xml;utf8,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><rect width="100" height="100" fill="none" stroke="%23ccc" stroke-width="0.5"/></svg>');
  }

  .color-option[data-color="paper-2"] {
    background-color: #f9f9f9;
    background-image: url('data:image/svg+xml;utf8,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="1" fill="%23ccc"/></svg>');
  }

  .color-option[data-color="paper-3"] {
    background-color: #f5f5f5;
    background-image: url('data:image/svg+xml;utf8,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><path d="M0 0 L10 10 M10 0 L0 10" stroke="%23ddd" stroke-width="0.5"/></svg>');
  }

  .color-option[data-color="paper-4"] {
    background-color: #fff;
    background-image: url('data:image/svg+xml;utf8,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><rect width="100" height="1" fill="%23eee"/><rect width="1" height="100" fill="%23eee"/></svg>');
  }

  .color-option[data-color="paper-5"] {
    background-color: #fafafa;
    background-image: url('data:image/svg+xml;utf8,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="25" fill="none" stroke="%23eee" stroke-width="0.5"/></svg>');
  }

</style>
</head>
<body>
  <div class="left-container" id="leftContainer">
    <h1>Categories</h1>
    <div class="categories" id="categoriesContainer">
      <!-- Categories will be dynamically populated here -->
    </div>
    <div id="miniatures" style="margin-top: 20px;">
      <h2>Cards in <span id="currentStackName">Default Stack</span></h2>
      <div class="miniature-container" id="miniatureContainer"></div>
    </div>
    <div id="stackManagement" style="margin-top: 20px;">
      <h2>Stack Management</h2>
      <button id="newStackBtn">New Stack</button>
      <button id="saveStackBtn">Save Stack</button>
      <button id="exportStackBtn">Export Stack</button>
      <input type="file" id="importStackInput" accept=".json" style="display: none;">
      <button id="importStackBtn">Import Stack</button>
      <button id="removeStackBtn">Delete Stack</button>
    </div>
  </div>
  
  <div class="right-container">

    <div class="flashcard" id="flashcard">
      <div class="flashcard-inner">
        <div class="flashcard-front">
          <div class="flashcard-title" id="frontCardTitle">Flashcard Title</div>
          <div class="flashcard-description" id="frontText">This is a brief description or question for the flashcard. Tap to see the answer!</div>
          <img id="frontCardImage" class="card-image" src="" alt="" style="display: none; max-width: 100%; max-height: 50%;">
          <audio id="frontCardAudio" controls style="display: none; margin-top: 10px;"></audio>
        </div>
        <div class="flashcard-back">
          <div class="flashcard-title" id="backCardTitle">Answer Title</div>
          <div class="flashcard-description" id="backText"></div>
          <img id="backCardImage" class="card-image" src="" alt="" style="display: none; max-width: 100%; max-height: 50%;">
          <audio id="backCardAudio" controls style="display: none; margin-top: 10px;"></audio>
        </div>
      </div>
    </div>
<div class="save-indicator" id="saveIndicator">Stack Saved!</div>
    <div class="flashcard-controls">
      <button class="nav-button" id="prevBtn">&#8592;</button>
      <div class="card-number">
        <span id="currentCardNumber">1</span> / <span id="totalCards">5</span>
      </div>
      <button id="customEditButton">Edit this Card</button>
      <button class="nav-button" id="nextBtn">&#8594;</button>
    </div>
	<div class="reorder-controls">
      <!-- <button id="moveUpBtn">Move Up</button>-->
      <!-- <button id="moveDownBtn">Move Down</button>-->
<!-- Botón para abrir el Modal de About -->
<button id="openAboutModal" class="Open">About</button>

    </div>

  </div>

  

<div id="editCardModal" class="edit-card-modal">
    <div class="edit-card-content">
      <span class="close-modal">&times;</span>
      <h2 id="editCardTitle">Edit Card</h2>
           
      <select id="frontTitleFont">
	<option value="Lato">Lato</option>
	<option value="Montserrat">Montserrat</option>
	<option value="Raleway">Raleway</option>
	<option value="Sofia">Sofia</option>
        <option value="Arial">Arial</option>
        <option value="Verdana">Verdana</option>
        <option value="Times New Roman">Times New Roman</option>
        <option value="Courier New">Courier New</option>
        <option value="Georgia">Georgia</option>
      </select>
      <input type="text" id="editFrontTitle" placeholder="Front Card Title">      
      <select id="frontTextFont">
	<option value="Lato">Lato</option>
	<option value="Montserrat">Montserrat</option>
	<option value="Raleway">Raleway</option>
	<option value="Sofia">Sofia</option>
        <option value="Arial">Arial</option>
        <option value="Verdana">Verdana</option>
        <option value="Times New Roman">Times New Roman</option>
        <option value="Courier New">Courier New</option>
        <option value="Georgia">Georgia</option>
      </select>
      <textarea id="editFrontText" placeholder="Front side text"></textarea>
      <input type="file" id="editFrontImage" accept="image/*">
      <button class="remove-media-btn" id="removeFrontImage">Remove Front Image</button>
      <input type="file" id="editFrontAudio" accept="audio/*">
      <button class="remove-media-btn" id="removeFrontAudio">Remove Front Audio</button>
      <h2 id="editCardTitle">Back Side</h2> 
      <select id="backTitleFont">
	<option value="Lato">Lato</option>
	<option value="Montserrat">Montserrat</option>
	<option value="Raleway">Raleway</option>
	<option value="Sofia">Sofia</option>
        <option value="Arial">Arial</option>
        <option value="Verdana">Verdana</option>
        <option value="Times New Roman">Times New Roman</option>
        <option value="Courier New">Courier New</option>
        <option value="Georgia">Georgia</option>
      </select>
      <input type="text" id="editBackTitle" placeholder="Back Card Title">
      <select id="backTextFont">
	<option value="Lato">Lato</option>
	<option value="Montserrat">Montserrat</option>
	<option value="Raleway">Raleway</option>
	<option value="Sofia">Sofia</option>
        <option value="Arial">Arial</option>
        <option value="Verdana">Verdana</option>
        <option value="Times New Roman">Times New Roman</option>
        <option value="Courier New">Courier New</option>
        <option value="Georgia">Georgia</option>
      </select>
      <textarea id="editBackText" placeholder="Back side text"></textarea>
      <input type="file" id="editBackImage" accept="image/*">
      <button class="remove-media-btn" id="removeBackImage">Remove Back Image</button>
      <input type="file" id="editBackAudio" accept="audio/*">
      <button class="remove-media-btn" id="removeBackAudio">Remove Back Audio</button>
      <h2 id="editCardTitle">Pick a Color for your Card</h2> 
      <div class="color-grid">
        <div class="color-option" style="background-color: #FFFFFF;" data-color="#FFFFFF"></div>
        <div class="color-option" style="background-color: #FFB3BA;" data-color="#FFB3BA"></div>
        <div class="color-option" style="background-color: #BAFFC9;" data-color="#BAFFC9"></div>
        <div class="color-option" style="background-color: #BAE1FF;" data-color="#BAE1FF"></div>
        <div class="color-option" style="background-color: #FFFFBA;" data-color="#FFFFBA"></div>
        <div class="color-option" style="background-color: #FFDFBA;" data-color="#FFDFBA"></div>
        <div class="color-option" style="background-color: #E0BBE4;" data-color="#E0BBE4"></div>
        <div class="color-option" style="background-color: #D4F0F0;" data-color="#D4F0F0"></div>
        <div class="color-option" style="background-color: #FFC6FF;" data-color="#FFC6FF"></div>
        <div class="color-option" style="background-color: #FFDAB9;" data-color="#FFDAB9"></div>
        <div class="color-option" style="background-color: #B0E0E6;" data-color="#B0E0E6"></div>
        <div class="color-option" style="background-color: #F0E68C;" data-color="#F0E68C"></div>
        <div class="color-option" data-color="gradient-1"></div>
        <div class="color-option" data-color="gradient-2"></div>
        <div class="color-option" data-color="gradient-3"></div>
        <div class="color-option" data-color="gradient-4"></div>
        <div class="color-option" data-color="gradient-5"></div>
        <div class="color-option" data-color="paper-1"></div>
        <div class="color-option" data-color="paper-2"></div>
        <div class="color-option" data-color="paper-3"></div>
        <div class="color-option" data-color="paper-4"></div>
        <div class="color-option" data-color="paper-5"></div>
        <div class="color-option" style="background-color: #98FB98;" data-color="#98FB98"></div>
        <div class="color-option" style="background-color: #DDA0DD;" data-color="#DDA0DD"></div>
        <div class="color-option" style="background-color: #F0FFF0;" data-color="#F0FFF0"></div>
        <div class="color-option" style="background-color: #F5F5DC;" data-color="#F5F5DC"></div>
        <div class="color-option" style="background-color: #FFF0F5;" data-color="#FFF0F5"></div>
        <div class="color-option" style="background-color: #E6E6FA;" data-color="#E6E6FA"></div>
      </div>
      <button id="saveEditBtn">Save Changes</button>
    </div>
  </div>



<!-- Toast personalizado -->
<div id="customToast" class="custom-toast">
  <span id="toastMessage">Mensaje del toast aquí.</span>

<span class="toast-close-btn">&times;</span>
  
</div>






<!-- Modal About-->
<div id="aboutModal" class="modal">
    <div class="modal-content">
	<span class="close">&times;</span>
        
	<h2>About this Application</h2>
        <p>Hello and Welcome, My name is Ismael, the Creator of this application that allows you to manage and organize your flashcards efficiently.</p> 

<p>You can create, edit, save, delete, and sort your cards easily. The application also offers features like image and audio attachments.</p>

 <p>Your cards are saved and stored locally in your computer, that means nobody else can see them unless you share the JSON file</p>

        <p>Customize the cards with different colors and fonts, and save your progress for later use. The application is designed to be intuitive, minimalistic, and user-friendly, I hope you enjoy it. ❤️</p>

<p>If you like our app, consider supporting the project through PayPal or Cafecito. Your donation makes a difference.</p> 

<p>v 01.12</p> 
    
      <div class="modal-footer">

	<a href="https://cafecito.app/theartificialpixel" target="_blank"><button class="link">Cafesito</button></a>

	<a href="https://www.paypal.com/donate/?business=CDCB3L5W4SKGN&no_recurring=0&item_name=Tu+donaci%C3%B3n+ayuda+a+mejorar+nuestra+aplicaci%C3%B3n+de+tarjetas.+%C2%A1Gracias+por+apoyar+nuestro+proyecto+y+hacer+que+siga+mejorando%21&currency_code=USD" target="_blank"><button class="link">Paypal</button></a>
   
	</div>
    </div>
</div>


  <script>
// Default Cards
    let flashcardStacks = {
      default: [
        { frontTitle: "Geography", backTitle: "Answer", frontText: "What is the capital of France?", backText: "Paris", color: "#FFB3BA", frontTitleFont: "Raleway", frontTextFont: "Montserrat", backTitleFont: "Raleway", backTextFont: "Montserrat" },
        { frontTitle: "Literature", backTitle: "Answer", frontText: "Who wrote 'Romeo and Juliet'?", backText: "William Shakespeare", color: "#BAFFC9", frontTitleFont: "Raleway", frontTextFont: "Montserrat", backTitleFont: "Raleway", backTextFont: "Montserrat" },
        { frontTitle: "Chemistry", backTitle: "Answer", frontText: "What is the chemical symbol for gold?", backText: "Au", color: "#BAE1FF", frontTitleFont: "Raleway", frontTextFont: "Montserrat", backTitleFont: "Raleway", backTextFont: "Montserrat" },
        { frontTitle: "History", backTitle: "Answer", frontText: "In which year did World War II end?", backText: "1945", color: "#FFFFBA", frontTitleFont: "Raleway", frontTextFont: "Montserrat", backTitleFont: "Raleway", backTextFont: "Montserrat" },
        { frontTitle: "Astronomy", backTitle: "Answer", frontText: "What is the largest planet in our solar system?", backText: "Jupiter", color: "#FFDFBA", frontTitleFont: "Raleway", frontTextFont: "Montserrat", backTitleFont: "Raleway", backTextFont: "Montserrat" }
      ]
    };

    let currentStack = 'default';
    let currentCardIndex = 0;
    let selectedColor = "#FFB3BA";

    const flashcardElement = document.getElementById('flashcard');
    const frontCardTitleElement = document.getElementById('frontCardTitle');
    const backCardTitleElement = document.getElementById('backCardTitle');
    const frontTextElement = document.getElementById('frontText');
    const backTextElement = document.getElementById('backText');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const newStackBtn = document.getElementById('newStackBtn');
    const saveStackBtn = document.getElementById('saveStackBtn');
    const frontCardImage = document.getElementById('frontCardImage');
    const backCardImage = document.getElementById('backCardImage');
    const frontCardAudio = document.getElementById('frontCardAudio');
    const backCardAudio = document.getElementById('backCardAudio');
    const colorOptions = document.querySelectorAll('.color-option');
    const exportStackBtn = document.getElementById('exportStackBtn');
    const importStackBtn = document.getElementById('importStackBtn');
    const importStackInput = document.getElementById('importStackInput');
    const miniatureContainer = document.getElementById('miniatureContainer');
    const saveIndicator = document.getElementById('saveIndicator');
    const editCardModal = document.getElementById('editCardModal');
    const editCardTitle = document.getElementById('editCardTitle');
    const closeModal = document.querySelector('.close-modal');
    const editFrontTitleInput = document.getElementById('editFrontTitle');
    const editBackTitleInput = document.getElementById('editBackTitle');
    const editFrontTextInput = document.getElementById('editFrontText');
    const editBackTextInput = document.getElementById('editBackText');
    const editFrontImageInput = document.getElementById('editFrontImage');
    const editBackImageInput = document.getElementById('editBackImage');
    const editFrontAudioInput = document.getElementById('editFrontAudio');
    const editBackAudioInput = document.getElementById('editBackAudio');
    const saveEditBtn = document.getElementById('saveEditBtn');
    const currentCardNumberElement = document.getElementById('currentCardNumber');
    const totalCardsElement = document.getElementById('totalCards');
    const categoriesContainer = document.getElementById('categoriesContainer');
    const currentStackNameElement = document.getElementById('currentStackName');
    const removeStackBtn = document.getElementById('removeStackBtn');
    const moveUpBtn = document.getElementById('moveUpBtn');
    const moveDownBtn = document.getElementById('moveDownBtn');
    const removeFrontImageBtn = document.getElementById('removeFrontImage');
    const removeBackImageBtn = document.getElementById('removeBackImage');
    const removeFrontAudioBtn = document.getElementById('removeFrontAudio');
    const removeBackAudioBtn = document.getElementById('removeBackAudio');
    const frontTitleFontSelect = document.getElementById('frontTitleFont');
    const frontTextFontSelect = document.getElementById('frontTextFont');
    const backTitleFontSelect = document.getElementById('backTitleFont');
    const backTextFontSelect = document.getElementById('backTextFont');

// --> Animaciones Working

function updateCard() {
    if (flashcardStacks[currentStack] && flashcardStacks[currentStack].length > 0) {
        const currentCard = flashcardStacks[currentStack][currentCardIndex];
        const flashcardElement = document.getElementById('flashcard');

        // Añadir clase de salida
        flashcardElement.classList.add('flashcard-leaving');

        // Esperar la transición de salida
        setTimeout(() => {
            // Actualizar el contenido de la tarjeta
            frontCardTitleElement.textContent = currentCard.frontTitle;
            backCardTitleElement.textContent = currentCard.backTitle;
            frontTextElement.textContent = currentCard.frontText;
            backTextElement.textContent = currentCard.backText;
            flashcardElement.classList.remove('flipped');
            
            document.querySelector('.flashcard-front').style.backgroundColor = currentCard.color;
            document.querySelector('.flashcard-back').style.backgroundColor = currentCard.color;

            frontCardTitleElement.style.fontFamily = currentCard.frontTitleFont;
            frontTextElement.style.fontFamily = currentCard.frontTextFont;
            backCardTitleElement.style.fontFamily = currentCard.backTitleFont;
            backTextElement.style.fontFamily = currentCard.backTextFont;

            if (currentCard.frontImage) {
                frontCardImage.src = currentCard.frontImage;
                frontCardImage.style.display = 'block';
            } else {
                frontCardImage.style.display = 'none';
            }

            if (currentCard.backImage) {
                backCardImage.src = currentCard.backImage;
                backCardImage.style.display = 'block';
            } else {
                backCardImage.style.display = 'none';
            }

            if (currentCard.frontAudio) {
                frontCardAudio.src = currentCard.frontAudio;
                frontCardAudio.style.display = 'block';
            } else {
                frontCardAudio.style.display = 'none';
            }

            if (currentCard.backAudio) {
                backCardAudio.src = currentCard.backAudio;
                backCardAudio.style.display = 'block';
            } else {
                backCardAudio.style.display = 'none';
            }

            currentCardNumberElement.textContent = currentCardIndex + 1;
            totalCardsElement.textContent = flashcardStacks[currentStack].length;

            // Remover la clase de salida y añadir la clase de entrada
            flashcardElement.classList.remove('flashcard-leaving');
            flashcardElement.classList.add('flashcard-entering');

            // Después de un breve tiempo, remover la clase de entrada
            setTimeout(() => {
                flashcardElement.classList.remove('flashcard-entering');
            }, 50); // Puedes ajustar el tiempo para una transición más suave
        }, 500); // Debe coincidir con la duración de la transición en CSS
    } else {
        // Si la pila actual está vacía o no existe
        frontCardTitleElement.textContent = "No Cards";
        backCardTitleElement.textContent = "No Cards";
        frontTextElement.textContent = "This stack is empty. Add some cards!";
        backTextElement.textContent = "This stack is empty. Add some cards!";
        currentCardNumberElement.textContent = "0";
        totalCardsElement.textContent = "0";
    }

    updateMiniatures();
    currentStackNameElement.textContent = currentStack;
}







// --> Cargar y Guardar de la Memoria Local Working 

    function saveToLocalStorage() {
      localStorage.setItem('flashcardStacks', JSON.stringify(flashcardStacks));
      showSaveIndicator();
    }

    function loadFromLocalStorage() {
      const savedStacks = localStorage.getItem('flashcardStacks');
      if (savedStacks) {
        flashcardStacks = JSON.parse(savedStacks);
        updateCard();
        updateCategories();
      }
    }

    function showSaveIndicator() {
      saveIndicator.classList.add('show');
      setTimeout(() => {
        saveIndicator.classList.remove('show');
      }, 2000);
    }






// --> Miniature Sorting

// Función para actualizar las miniaturas
function updateMiniatures() {
  miniatureContainer.innerHTML = '';
  
  // Añadir la miniatura "Nueva Tarjeta"
  const newCardMiniature = document.createElement('div');
  newCardMiniature.className = 'miniature-card new-card-miniature';
  newCardMiniature.innerHTML = '+';
  newCardMiniature.onclick = openNewCardModal;
  miniatureContainer.appendChild(newCardMiniature);

  if (flashcardStacks[currentStack]) {
    flashcardStacks[currentStack].forEach((card, index) => {
      const miniature = document.createElement('div');
      miniature.className = 'miniature-card';
      miniature.style.backgroundColor = card.color;
      miniature.textContent = card.frontTitle;
      miniature.dataset.id = index.toString(); // Añadir un identificador único
      miniature.onclick = () => {
        currentCardIndex = index;
        updateCard();
      };

      const actions = document.createElement('div');
      actions.className = 'miniature-actions';
      
      const editBtn = document.createElement('button');
      editBtn.textContent = 'Edit';
      editBtn.onclick = (e) => {
        e.stopPropagation();
        openEditModal(index);
      };

      const deleteBtn = document.createElement('button');
      deleteBtn.textContent = 'Delete';
      deleteBtn.onclick = (e) => {
        e.stopPropagation();
        deleteCard(index);
      };

      actions.appendChild(editBtn);
      actions.appendChild(deleteBtn);
      miniature.appendChild(actions);
      miniatureContainer.appendChild(miniature);
    });
  }

  // Inicializar Sortable después de añadir las miniaturas
  initializeSortable();
}

// Función para inicializar Sortable
function initializeSortable() {
  new Sortable(miniatureContainer, {
    animation: 150,
    ghostClass: 'sortable-ghost',
    filter: '.new-card-miniature', // Evitar que la miniatura "Nueva Tarjeta" sea arrastrable
    onEnd: function(evt) {
      saveNewOrder();
    }
  });
}

// Función para guardar el nuevo orden
function saveNewOrder() {
  const miniatures = Array.from(miniatureContainer.querySelectorAll('.miniature-card:not(.new-card-miniature)'));
  const newOrder = miniatures.map(miniature => parseInt(miniature.dataset.id));
  
  // Reordenar el array de tarjetas en el stack actual
  flashcardStacks[currentStack] = newOrder.map(index => flashcardStacks[currentStack][index]);
  
  // Guardar el nuevo orden en localStorage
  localStorage.setItem('flashcardStacks', JSON.stringify(flashcardStacks));
}

// Evento que se ejecuta cuando el DOM está completamente cargado
document.addEventListener('DOMContentLoaded', function() {
  loadFlashcardStacks();
  updateMiniatures();
});

// Función para cargar los stacks de flashcards
function loadFlashcardStacks() {
  const stacksData = JSON.parse(localStorage.getItem('flashcardStacks'));
  if (stacksData) {
    flashcardStacks = stacksData;
  } else {
    flashcardStacks = {}; // Inicializa vacío si no hay datos
  }
}

// --> Miniature Sorting







// --> Custom Edit button y Codigo del Toast Working
 
document.addEventListener('DOMContentLoaded', function() {
    const customEditButton = document.getElementById('customEditButton');
    const toast = document.getElementById('customToast');
    const toastMessage = document.getElementById('toastMessage');
    const closeToastBtn = document.querySelector('.toast-close-btn');

    // Función para mostrar el toast con un mensaje
    function showToast(message) {
        toastMessage.textContent = message;
        toast.classList.add('show');
        setTimeout(() => {
            toast.classList.remove('show');
        }, 3000); // El toast se oculta después de 3 segundos
    }

    // Cerrar el toast al hacer clic en el botón de cerrar
    closeToastBtn.onclick = function() {
        toast.classList.remove('show');
    }

    customEditButton.onclick = function() {
        // Verifica si flashcardStacks y currentStack están definidos
        if (typeof flashcardStacks === 'undefined' || typeof currentStack === 'undefined') {
            showToast("No card stacks available. Please check your stack settings.");
            return;
        }

        // Verifica si el stack actual es válido
        const currentCards = flashcardStacks[currentStack];
        if (!currentCards) {
            showToast("Current Stack has no Cards, Pick a Card to edit.");
            return;
        }

        // Obtén el índice actual de la tarjeta (resta 1 para convertirlo a un índice basado en cero)
        const currentCardIndex = parseInt(document.getElementById('currentCardNumber').textContent) - 1;
        const totalCards = currentCards.length;

        // Verifica si el índice es válido
        if (currentCardIndex < 0 || currentCardIndex >= totalCards) {
            showToast("Pick a card to edit.");
        } else {
            // Abre el modal para el índice de la tarjeta actual
            openEditModal(currentCardIndex);
        }
    };
});

// Tiempo de animacion del Toast

setTimeout(() => {
    toast.classList.remove('show');
}, 4000); // El toast se oculta después de 3 segundos


// --> Añadir Tarjeta y Crear nuevo Stack Working

    function addCard(frontTitle, backTitle, frontText, backText, frontImage, backImage, frontAudio, backAudio, color) {
      if (!flashcardStacks[currentStack]) {
        flashcardStacks[currentStack] = [];
      }
      flashcardStacks[currentStack].push({ frontTitle, backTitle, frontText, backText, frontImage, backImage, frontAudio, backAudio, color });
      updateCard();
      saveToLocalStorage();
      updateCategories();
    }

    function createNewStack(stackName) {
      if (!flashcardStacks[stackName]) {
        flashcardStacks[stackName] = [];
        saveToLocalStorage();
        updateCategories();
      }
    }

// --> Cargar y Guardar de la Memoria Local Working 

    function saveToLocalStorage() {
      localStorage.setItem('flashcardStacks', JSON.stringify(flashcardStacks));
      showSaveIndicator();
    }

    function loadFromLocalStorage() {
      const savedStacks = localStorage.getItem('flashcardStacks');
      if (savedStacks) {
        flashcardStacks = JSON.parse(savedStacks);
        updateCard();
        updateCategories();
      }
    }

    function showSaveIndicator() {
      saveIndicator.classList.add('show');
      setTimeout(() => {
        saveIndicator.classList.remove('show');
      }, 2000);
    }

// --> New Card Modal Working

function openNewCardModal() {
   editFrontTitleInput.value = '';
   editBackTitleInput.value = '';
   editFrontTextInput.value = '';
   editBackTextInput.value = '';
   editFrontImageInput.value = '';
   editBackImageInput.value = '';
   editFrontAudioInput.value = '';
   editBackAudioInput.value = '';
   selectedColor = '#FFFFFF';
   frontTitleFontSelect.value = 'Raleway';
   frontTextFontSelect.value = 'Montserrat';
   backTitleFontSelect.value = 'Raleway';
   backTextFontSelect.value = 'Montserrat';
   currentCardIndex = flashcardStacks[currentStack] ? flashcardStacks[currentStack].length : 0;
   editCardTitle.textContent = "New Card";
   editCardModal.style.display = 'block';
   isModalOpen = true; // Establecer a true cuando se abre el modal
}

function closeNewCardModal() {
   editCardModal.style.display = 'none';
   isModalOpen = false; // Establecer a false cuando se cierra el modal
}

closeModal.addEventListener('click', closeNewCardModal);

saveEditBtn.addEventListener('click', () => {
   saveEditedCard();
   closeNewCardModal(); // Asegurarse de que isModalOpen se establezca a false al guardar
});

window.onclick = function(event) {
   if (event.target == editCardModal) {
      closeNewCardModal();
   }
};




// --> Guardar Tarjeta Editada Working

    function saveEditedCard() {
      if (!flashcardStacks[currentStack]) {
        flashcardStacks[currentStack] = [];
      }
      if (currentCardIndex === flashcardStacks[currentStack].length) {
        // This is a new card
        flashcardStacks[currentStack].push({});
      }
      const currentCard = flashcardStacks[currentStack][currentCardIndex];
      currentCard.frontTitle = editFrontTitleInput.value;
      currentCard.backTitle = editBackTitleInput.value;
      currentCard.frontText = editFrontTextInput.value;
      currentCard.backText = editBackTextInput.value;
      currentCard.color = selectedColor;
	 currentCard.frontTitleFont = frontTitleFontSelect.value;
      currentCard.frontTextFont = frontTextFontSelect.value;
      currentCard.backTitleFont = backTitleFontSelect.value;
      currentCard.backTextFont = backTextFontSelect.value;


      handleFileInput(editFrontImageInput, 'frontImage', currentCard);
      handleFileInput(editBackImageInput, 'backImage', currentCard);
      handleFileInput(editFrontAudioInput, 'frontAudio', currentCard);
      handleFileInput(editBackAudioInput, 'backAudio', currentCard);

      updateCard();
      saveToLocalStorage();
      closeEditModal();
      updateCategories();
    }

    function handleFileInput(input, property, card) {
      if (input.files.length > 0) {
        const file = input.files[0];
        const reader = new FileReader();
        reader.onload = function(e) {
          card[property] = e.target.result;
          updateCard();
        };
        if (property.includes('Image')) {
          reader.readAsDataURL(file);
        } else if (property.includes('Audio')) {
          reader.readAsArrayBuffer(file);
        }
      }
    }

// --> Remove Media Modal Working

document.addEventListener('click', function(event) {
    // Quitar imagen frontal
    if (event.target.id === 'removeFrontImage') {
        var card = event.target.closest('.card');
        var frontImage = card.querySelector('.front img');
        if (frontImage) {
            frontImage.remove();
        }
    }

    // Quitar audio frontal
    if (event.target.id === 'removeFrontAudio') {
        var card = event.target.closest('.card');
        var frontAudio = card.querySelector('.front audio');
        if (frontAudio) {
            frontAudio.remove();
        }
    }

    // Quitar imagen trasera
    if (event.target.id === 'removeBackImage') {
        var card = event.target.closest('.card');
        var backImage = card.querySelector('.back img');
        if (backImage) {
            backImage.remove();
        }
    }

    // Quitar audio trasero
    if (event.target.id === 'removeBackAudio') {
        var card = event.target.closest('.card');
        var backAudio = card.querySelector('.back audio');
        if (backAudio) {
            backAudio.remove();
        }
    }
});

// --> Actualizar despues de remover Media Working

function updateCardDisplay() {
    const currentCard = flashcardStacks[currentStack][currentCardIndex];

    // Actualizar la imagen frontal y trasera en la interfaz
    const frontImageElement = document.querySelector('.card-front img');
    const backImageElement = document.querySelector('.card-back img');
    const frontAudioElement = document.querySelector('.card-front audio');
    const backAudioElement = document.querySelector('.card-back audio');

    if (frontImageElement) {
        frontImageElement.src = currentCard.frontImage || '';
        if (!currentCard.frontImage) frontImageElement.remove();
    }

    if (backImageElement) {
        backImageElement.src = currentCard.backImage || '';
        if (!currentCard.backImage) backImageElement.remove();
    }

    if (frontAudioElement) {
        frontAudioElement.src = currentCard.frontAudio || '';
        if (!currentCard.frontAudio) frontAudioElement.remove();
    }

    if (backAudioElement) {
        backAudioElement.src = currentCard.backAudio || '';
        if (!currentCard.backAudio) backAudioElement.remove();
    }

    // Si es necesario, puedes agregar más código para refrescar otros elementos de la tarjeta
}        


// --> Borrar Tarjeta Working

    function deleteCard(index) {
      if (confirm('Are you sure you want to delete this card?')) {
        flashcardStacks[currentStack].splice(index, 1);
        if (currentCardIndex >= flashcardStacks[currentStack].length) {
          currentCardIndex = flashcardStacks[currentStack].length - 1;
        }
        updateCard();
        saveToLocalStorage();
        updateCategories();
      }
    }


// --> Funcion de Sortear y Renombrar Categorias Working

function updateCategories() {
  categoriesContainer.innerHTML = '';
  
  Object.keys(flashcardStacks).forEach((stackName, index) => {
    const category = document.createElement('div');
    category.className = 'category';
    category.innerHTML = `
      <div class="category-icon drag-handle">${stackName[0].toUpperCase()}</div>
      <span class="category-name">${stackName}</span>
      <span class="category-count">${flashcardStacks[stackName].length} cards</span>
      <span class="category-remove">&#10005;</span>
    `;

    // Hacer la categoría editable con doble clic
    const categoryNameElement = category.querySelector('.category-name');
    categoryNameElement.ondblclick = function () {
      const input = document.createElement('input');
      input.type = 'text';
      input.value = stackName;
      input.className = 'edit-category-input';
      categoryNameElement.innerHTML = '';
      categoryNameElement.appendChild(input);
      input.focus();
      input.select();
      
      input.onblur = function () {
        saveNewCategoryName(stackName, input.value);
      };
      input.onkeydown = function (e) {
        if (e.key === 'Enter') {
          saveNewCategoryName(stackName, input.value);
        }
      };
    };

    category.onclick = (e) => {
      // Evitar cambiar de categoría cuando se hace clic en el icono de arrastre
      if (!e.target.classList.contains('drag-handle')) {
        currentStack = stackName;
        currentCardIndex = 0;
        updateCard();
      }
    };

    categoriesContainer.appendChild(category);
  });

  // Inicializar Sortable.js en el contenedor de categorías
  new Sortable(categoriesContainer, {
    animation: 150,
    handle: '.drag-handle', // Especifica el selector para el manejador de arrastre
    ghostClass: 'sortable-ghost',
    onEnd: function (evt) {
      const newOrder = Array.from(categoriesContainer.children).map(
        category => category.querySelector('.category-name').textContent
      );
      const reorderedStacks = {};
      newOrder.forEach(stackName => {
        reorderedStacks[stackName] = flashcardStacks[stackName];
      });
      flashcardStacks = reorderedStacks;
    }
  });
}

function saveNewCategoryName(oldName, newName) {
  if (newName && newName !== oldName) {
    if (!flashcardStacks[newName]) {
      flashcardStacks[newName] = flashcardStacks[oldName];
      delete flashcardStacks[oldName];
      updateCategories();
    } else {
      alert('Category name already exists.');
    }
  } else {
    updateCategories();
  }
}

// --> Edit modal Working 

// Variable global para controlar si el modal está abierto
let isModalOpen = false;

function openEditModal(index) {
  currentCardIndex = index;
  const currentCard = flashcardStacks[currentStack][currentCardIndex];
      editFrontTitleInput.value = currentCard.frontTitle;
      editBackTitleInput.value = currentCard.backTitle;
      editFrontTextInput.value = currentCard.frontText;
      editBackTextInput.value = currentCard.backText;
      selectedColor = currentCard.color;
      frontTitleFontSelect.value = currentCard.frontTitleFont;
      frontTextFontSelect.value = currentCard.frontTextFont;
      backTitleFontSelect.value = currentCard.backTitleFont;
      backTextFontSelect.value = currentCard.backTextFont;
      editCardTitle.textContent = "Edit Card";
      editCardModal.style.display = 'block';

          // Conectar los botones de remover imagen y audio
    document.getElementById('removeFrontImage').onclick = function() {
        currentCard.frontImage = ''; // Remover imagen frontal
        updateCardDisplay(); // Actualizar la tarjeta en el display
    };
    
    document.getElementById('removeBackImage').onclick = function() {
        currentCard.backImage = ''; // Remover imagen trasera
        updateCardDisplay(); // Actualizar la tarjeta en el display
    };

    document.getElementById('removeFrontAudio').onclick = function() {
        currentCard.frontAudio = ''; // Remover audio frontal
        updateCardDisplay(); // Actualizar la tarjeta en el display
    };

    document.getElementById('removeBackAudio').onclick = function() {
        currentCard.backAudio = ''; // Remover audio trasero
        updateCardDisplay(); // Actualizar la tarjeta en el display
    };
    
    isModalOpen = true; // Establecer a true cuando se abre el modal
    }

// --> Close Edit Modal

    function closeEditModal() {
  editCardModal.style.display = 'none';
  isModalOpen = false; // Establecer a false cuando se cierra el modal
}

closeModal.addEventListener('click', closeEditModal);

saveEditBtn.addEventListener('click', () => {
  saveEditedCard();
  closeEditModal(); // Asegurarse de que isModalOpen se establezca a false al guardar
});

window.onclick = function(event) {
  if (event.target == editCardModal) {
    closeEditModal();
  }
};

// --> Navegacion Por Teclado y Flip Animation Working

// Función para manejar la navegación y el efecto flip
function navigateCard(direction) {
  if (isModalOpen) return; // Si el modal está abierto, no hacer nada
  if (flashcardStacks[currentStack] && flashcardStacks[currentStack].length > 0) {
    flashcardElement.classList.remove('flipped');
    setTimeout(() => {
      if (direction === 'prev') {
        currentCardIndex = (currentCardIndex - 1 + flashcardStacks[currentStack].length) % flashcardStacks[currentStack].length;
      } else if (direction === 'next') {
        currentCardIndex = (currentCardIndex + 1) % flashcardStacks[currentStack].length;
      }
      updateCard();
    }, 300);
  }
}

// Manejadores de eventos para los botones de navegación
prevBtn.addEventListener('click', () => {
  if (!isModalOpen) navigateCard('prev');
});

nextBtn.addEventListener('click', () => {
  if (!isModalOpen) navigateCard('next');
});


// Manejar la navegación y el flip con el teclado
document.addEventListener('keydown', (event) => {
  if (isModalOpen) return; // Si el modal está abierto, no hacer nada
  if (event.key === 'ArrowLeft') {
    navigateCard('prev');
  } else if (event.key === 'ArrowRight') {
    navigateCard('next');
  } else if (event.key === ' ') {
    event.preventDefault();
    flashcardElement.classList.toggle('flipped');
  }
});

// Manejador del flip al hacer clic
flashcardElement.addEventListener('click', () => {
  if (!isModalOpen) {
    flashcardElement.classList.toggle('flipped');
  }
});
// --> Color for every card Working

    colorOptions.forEach(option => {
      option.addEventListener('click', (e) => {
        selectedColor = e.target.getAttribute('data-color');
        document.querySelector('.flashcard-front').style.backgroundColor = selectedColor;
        document.querySelector('.flashcard-back').style.backgroundColor = selectedColor;
      });
    });


// --> Abre y Cierra el Modal About Working

document.addEventListener('DOMContentLoaded', function() {
    var modal = document.getElementById('aboutModal');
    var btn = document.getElementById('openAboutModal');
    var span = document.getElementsByClassName('close')[0];

    // Abre el modal
    btn.onclick = function() {
        modal.style.display = 'block';
    }

    // Cierra el modal cuando se hace clic en la "x"
    span.onclick = function() {
        modal.style.display = 'none';
    }

    // Cierra el modal cuando se hace clic fuera del contenido
    window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = 'none';
        }
    }
});


// --> New, Save, Remove, Export Import Working

    newStackBtn.addEventListener('click', () => {
      const stackName = prompt("Enter a name for the new stack:");
      if (stackName) {
        createNewStack(stackName);
        currentStack = stackName;
        currentCardIndex = 0;
        updateCard();
      }
    });

    saveStackBtn.addEventListener('click', () => {
      saveToLocalStorage();
    });

    removeStackBtn.addEventListener('click', () => {
      removeStack(currentStack);
    });

    function removeStack(stackName) {
      if (confirm(`Are you sure you want to remove the "${stackName}" stack?`)) {
        delete flashcardStacks[stackName];
        if (currentStack === stackName) {
          currentStack = Object.keys(flashcardStacks)[0] || 'default';
          currentCardIndex = 0;
        }
        updateCard();
        saveToLocalStorage();
        updateCategories();
      }
    }

    exportStackBtn.addEventListener('click', () => {
      const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(flashcardStacks[currentStack]));
      const downloadAnchorNode = document.createElement('a');
      downloadAnchorNode.setAttribute("href", dataStr);
      downloadAnchorNode.setAttribute("download", currentStack + "_flashcards.json");
      document.body.appendChild(downloadAnchorNode);
      downloadAnchorNode.click();
      downloadAnchorNode.remove();
    });

    importStackBtn.addEventListener('click', () => {
      importStackInput.click();
    });

    importStackInput.addEventListener('change', (event) => {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          try {
            const importedStack = JSON.parse(e.target.result);
            const stackName = prompt("Enter a name for the imported stack:");
            if (stackName) {
              flashcardStacks[stackName] = importedStack;
              createNewStack(stackName);
              currentStack = stackName;
              currentCardIndex = 0;
              updateCard();
              saveToLocalStorage();
              updateCategories();
            }
          } catch (error) {
            console.error("Error importing stack:", error);
            alert("Error importing stack. Please make sure the file is a valid JSON.");
          }
        };
        reader.readAsText(file);
      }
    });

    loadFromLocalStorage();
    updateCard();
    updateCategories();


  </script>

</body></html>